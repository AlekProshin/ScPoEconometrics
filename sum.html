<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Econometrics with R at SciencesPo [WIP]</title>
  <meta name="description" content="SciencesPo UG Econometrics online textbook. No Maths.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Econometrics with R at SciencesPo [WIP]" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://floswald.github.io/ScPoEconometrics/" />
  
  <meta property="og:description" content="SciencesPo UG Econometrics online textbook. No Maths." />
  <meta name="github-repo" content="floswald/ScPoEconometrics" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Econometrics with R at SciencesPo [WIP]" />
  
  <meta name="twitter:description" content="SciencesPo UG Econometrics online textbook. No Maths." />
  

<meta name="author" content="Florian Oswald and Jean-Marc Robin">


<meta name="date" content="2018-05-23">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  <link rel="shortcut icon" href="favicon.gif" type="image/x-icon">
<link rel="prev" href="R-intro.html">
<link rel="next" href="linreg.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-41584331-4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-41584331-4');
</script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">ScPo 2nd Year Econometrics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Econometrics at ScPo - WORK IN PROGRESS</a></li>
<li class="chapter" data-level="2" data-path="R-intro.html"><a href="R-intro.html"><i class="fa fa-check"></i><b>2</b> Introduction to <code>R</code></a><ul>
<li class="chapter" data-level="2.1" data-path="R-intro.html"><a href="R-intro.html#getting-started"><i class="fa fa-check"></i><b>2.1</b> Getting Started</a></li>
<li class="chapter" data-level="2.2" data-path="R-intro.html"><a href="R-intro.html#basic-calculations"><i class="fa fa-check"></i><b>2.2</b> Basic Calculations</a></li>
<li class="chapter" data-level="2.3" data-path="R-intro.html"><a href="R-intro.html#getting-help"><i class="fa fa-check"></i><b>2.3</b> Getting Help</a></li>
<li class="chapter" data-level="2.4" data-path="R-intro.html"><a href="R-intro.html#installing-packages"><i class="fa fa-check"></i><b>2.4</b> Installing Packages</a></li>
<li class="chapter" data-level="2.5" data-path="R-intro.html"><a href="R-intro.html#data-types"><i class="fa fa-check"></i><b>2.5</b> Data Types</a></li>
<li class="chapter" data-level="2.6" data-path="R-intro.html"><a href="R-intro.html#data-structures"><i class="fa fa-check"></i><b>2.6</b> Data Structures</a><ul>
<li class="chapter" data-level="2.6.1" data-path="R-intro.html"><a href="R-intro.html#vectors"><i class="fa fa-check"></i><b>2.6.1</b> Vectors</a></li>
<li class="chapter" data-level="2.6.2" data-path="R-intro.html"><a href="R-intro.html#vectorization"><i class="fa fa-check"></i><b>2.6.2</b> Vectorization</a></li>
<li class="chapter" data-level="2.6.3" data-path="R-intro.html"><a href="R-intro.html#logical-operators"><i class="fa fa-check"></i><b>2.6.3</b> Logical Operators</a></li>
<li class="chapter" data-level="2.6.4" data-path="R-intro.html"><a href="R-intro.html#more-vectorization"><i class="fa fa-check"></i><b>2.6.4</b> More Vectorization</a></li>
<li class="chapter" data-level="2.6.5" data-path="R-intro.html"><a href="R-intro.html#matrices"><i class="fa fa-check"></i><b>2.6.5</b> Matrices</a></li>
<li class="chapter" data-level="2.6.6" data-path="R-intro.html"><a href="R-intro.html#lists"><i class="fa fa-check"></i><b>2.6.6</b> Lists</a></li>
<li class="chapter" data-level="2.6.7" data-path="R-intro.html"><a href="R-intro.html#dataframes"><i class="fa fa-check"></i><b>2.6.7</b> Data Frames</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="R-intro.html"><a href="R-intro.html#programming-basics"><i class="fa fa-check"></i><b>2.7</b> Programming Basics</a><ul>
<li class="chapter" data-level="2.7.1" data-path="R-intro.html"><a href="R-intro.html#control-flow"><i class="fa fa-check"></i><b>2.7.1</b> Control Flow</a></li>
<li class="chapter" data-level="2.7.2" data-path="R-intro.html"><a href="R-intro.html#functions"><i class="fa fa-check"></i><b>2.7.2</b> Functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sum.html"><a href="sum.html"><i class="fa fa-check"></i><b>3</b> Working With Data</a><ul>
<li class="chapter" data-level="3.1" data-path="sum.html"><a href="sum.html#summary-statistics"><i class="fa fa-check"></i><b>3.1</b> Summary Statistics</a><ul>
<li class="chapter" data-level="" data-path="sum.html"><a href="sum.html#central-tendency"><i class="fa fa-check"></i>Central Tendency</a></li>
<li class="chapter" data-level="" data-path="sum.html"><a href="sum.html#spread"><i class="fa fa-check"></i>Spread</a></li>
<li class="chapter" data-level="" data-path="sum.html"><a href="sum.html#categorical"><i class="fa fa-check"></i>Categorical</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="sum.html"><a href="sum.html#plotting"><i class="fa fa-check"></i><b>3.2</b> Plotting</a><ul>
<li class="chapter" data-level="3.2.1" data-path="sum.html"><a href="sum.html#histograms"><i class="fa fa-check"></i><b>3.2.1</b> Histograms</a></li>
<li class="chapter" data-level="3.2.2" data-path="sum.html"><a href="sum.html#barplots"><i class="fa fa-check"></i><b>3.2.2</b> Barplots</a></li>
<li class="chapter" data-level="3.2.3" data-path="sum.html"><a href="sum.html#boxplots"><i class="fa fa-check"></i><b>3.2.3</b> Boxplots</a></li>
<li class="chapter" data-level="3.2.4" data-path="sum.html"><a href="sum.html#scatterplots"><i class="fa fa-check"></i><b>3.2.4</b> Scatterplots</a></li>
<li class="chapter" data-level="3.2.5" data-path="sum.html"><a href="sum.html#ggplot"><i class="fa fa-check"></i><b>3.2.5</b> <code>ggplot</code></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="sum.html"><a href="sum.html#the-tidyverse"><i class="fa fa-check"></i><b>3.3</b> The <code>tidyverse</code></a></li>
<li class="chapter" data-level="3.4" data-path="sum.html"><a href="sum.html#example-importing-excel-data"><i class="fa fa-check"></i><b>3.4</b> Example: Importing Excel Data</a><ul>
<li class="chapter" data-level="3.4.1" data-path="sum.html"><a href="sum.html#tidyr"><i class="fa fa-check"></i><b>3.4.1</b> <code>tidyr</code></a></li>
<li class="chapter" data-level="3.4.2" data-path="sum.html"><a href="sum.html#dplyr"><i class="fa fa-check"></i><b>3.4.2</b> <code>dplyr</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="linreg.html"><a href="linreg.html"><i class="fa fa-check"></i><b>4</b> Linear Regression</a><ul>
<li class="chapter" data-level="4.1" data-path="linreg.html"><a href="linreg.html#data-on-cars"><i class="fa fa-check"></i><b>4.1</b> Data on Cars</a><ul>
<li class="chapter" data-level="4.1.1" data-path="linreg.html"><a href="linreg.html#how-are-speed-and-dist-related"><i class="fa fa-check"></i><b>4.1.1</b> How are <code>speed</code> and <code>dist</code> related?</a></li>
<li class="chapter" data-level="4.1.2" data-path="linreg.html"><a href="linreg.html#non-linear-data"><i class="fa fa-check"></i><b>4.1.2</b> non-linear data</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="linreg.html"><a href="linreg.html#try-to-find-the-slope"><i class="fa fa-check"></i><b>4.2</b> Try to find the Slope!</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="std-errors.html"><a href="std-errors.html"><i class="fa fa-check"></i><b>5</b> Standard Errors</a></li>
<li class="chapter" data-level="6" data-path="multiple-reg.html"><a href="multiple-reg.html"><i class="fa fa-check"></i><b>6</b> Multiple Regression</a></li>
<li class="chapter" data-level="7" data-path="categorical-vars.html"><a href="categorical-vars.html"><i class="fa fa-check"></i><b>7</b> Categorial Variables: Dummies and Interactions</a></li>
<li class="chapter" data-level="8" data-path="quantreg.html"><a href="quantreg.html"><i class="fa fa-check"></i><b>8</b> Quantile Regression</a></li>
<li class="chapter" data-level="9" data-path="panel-data.html"><a href="panel-data.html"><i class="fa fa-check"></i><b>9</b> Panel Data</a></li>
<li class="chapter" data-level="10" data-path="IV.html"><a href="IV.html"><i class="fa fa-check"></i><b>10</b> Instrumental Variables</a></li>
<li class="chapter" data-level="11" data-path="logit-probit.html"><a href="logit-probit.html"><i class="fa fa-check"></i><b>11</b> Logit and Probit</a></li>
<li class="chapter" data-level="12" data-path="pca.html"><a href="pca.html"><i class="fa fa-check"></i><b>12</b> Principal Component Analysis</a></li>
<li class="chapter" data-level="13" data-path="notes.html"><a href="notes.html"><i class="fa fa-check"></i><b>13</b> Notes</a><ul>
<li class="chapter" data-level="13.1" data-path="notes.html"><a href="notes.html#book-usage"><i class="fa fa-check"></i><b>13.1</b> Book usage</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Econometrics with R at SciencesPo [WIP]</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sum" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Working With Data</h1>
<p>In this chapter we will first learn some basic concepts that help summarizing data. Then, we will tackle a real-world task and read, clean, and summarize data from the web.</p>
<div id="summary-statistics" class="section level2">
<h2><span class="header-section-number">3.1</span> Summary Statistics</h2>
<p><code>R</code> has built in functions for a large number of summary statistics. For numeric variables, we can summarize data by looking at their center and spread, for example. <em>Make sure to have loaded the <code>ggplot2</code> library to be able to access the <code>mpg</code> dataset as introduced in section <a href="R-intro.html#dataframes">2.6.7</a>.</em></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)</code></pre></div>
<div id="central-tendency" class="section level3 unnumbered">
<h3>Central Tendency</h3>
<p>Suppose we want to know the <em>mean</em> and <em>median</em> of all the values stored in the <code>data.frame</code> column <code>mpg$cty</code>:</p>
<table>
<thead>
<tr class="header">
<th>Measure</th>
<th><code>R</code></th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Mean</td>
<td><code>mean(mpg$cty)</code></td>
<td>16.8589744</td>
</tr>
<tr class="even">
<td>Median</td>
<td><code>median(mpg$cty)</code></td>
<td>17</td>
</tr>
</tbody>
</table>
</div>
<div id="spread" class="section level3 unnumbered">
<h3>Spread</h3>
<p>How do the values in that column <em>vary</em>? How far <em>spread out</em> are they?</p>
<table>
<thead>
<tr class="header">
<th>Measure</th>
<th><code>R</code></th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Variance</td>
<td><code>var(mpg$cty)</code></td>
<td>18.1130736</td>
</tr>
<tr class="even">
<td>Standard Deviation</td>
<td><code>sd(mpg$cty)</code></td>
<td>4.2559457</td>
</tr>
<tr class="odd">
<td>IQR</td>
<td><code>IQR(mpg$cty)</code></td>
<td>5</td>
</tr>
<tr class="even">
<td>Minimum</td>
<td><code>min(mpg$cty)</code></td>
<td>9</td>
</tr>
<tr class="odd">
<td>Maximum</td>
<td><code>max(mpg$cty)</code></td>
<td>35</td>
</tr>
<tr class="even">
<td>Range</td>
<td><code>range(mpg$cty)</code></td>
<td>9, 35</td>
</tr>
</tbody>
</table>
</div>
<div id="categorical" class="section level3 unnumbered">
<h3>Categorical</h3>
<p>For categorical variables, counts and percentages can be used for summary.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(mpg<span class="op">$</span>drv)</code></pre></div>
<pre><code>## 
##   4   f   r 
## 103 106  25</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(mpg<span class="op">$</span>drv) <span class="op">/</span><span class="st"> </span><span class="kw">nrow</span>(mpg)</code></pre></div>
<pre><code>## 
##         4         f         r 
## 0.4401709 0.4529915 0.1068376</code></pre>
</div>
</div>
<div id="plotting" class="section level2">
<h2><span class="header-section-number">3.2</span> Plotting</h2>
<p>Now that we have some data to work with, and we have learned about the data at the most basic level, our next tasks will be to visualize it. Often, a proper visualization can illuminate features of the data that can inform further analysis.</p>
<p>We will look at four methods of visualizing data by using the basic <code>plot</code> facilities built-in with <code>R</code>:</p>
<ul>
<li>Histograms</li>
<li>Barplots</li>
<li>Boxplots</li>
<li>Scatterplots</li>
</ul>
<div id="histograms" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Histograms</h3>
<p>When visualizing a single numerical variable, a <strong>histogram</strong> is useful. It summarizes the <em>distribution</em> of values in a vector. In <code>R</code> you create one using the <code>hist()</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(mpg<span class="op">$</span>cty)</code></pre></div>
<p><img src="ScPoEconometrics_files/figure-html/unnamed-chunk-102-1.png" width="672" /></p>
<p>The histogram function has a number of parameters which can be changed to make our plot look much nicer. Use the <code>?</code> operator to read the documentation for the <code>hist()</code> to see a full list of these parameters.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(mpg<span class="op">$</span>cty,
     <span class="dt">xlab   =</span> <span class="st">&quot;Miles Per Gallon (City)&quot;</span>,
     <span class="dt">main   =</span> <span class="st">&quot;Histogram of MPG (City)&quot;</span>, <span class="co"># main title</span>
     <span class="dt">breaks =</span> <span class="dv">12</span>,   <span class="co"># how many breaks?</span>
     <span class="dt">col    =</span> <span class="st">&quot;red&quot;</span>,
     <span class="dt">border =</span> <span class="st">&quot;blue&quot;</span>)</code></pre></div>
<p><img src="ScPoEconometrics_files/figure-html/unnamed-chunk-103-1.png" width="672" /></p>
<p>Importantly, you should always be sure to label your axes and give the plot a title. The argument <code>breaks</code> is specific to <code>hist()</code>. Entering an integer will give a suggestion to <code>R</code> for how many bars to use for the histogram. By default <code>R</code> will attempt to intelligently guess a good number of <code>breaks</code>, but as we can see here, it is sometimes useful to modify this yourself.</p>
</div>
<div id="barplots" class="section level3">
<h3><span class="header-section-number">3.2.2</span> Barplots</h3>
<p>Somewhat similar to a histogram, a barplot can provide a visual summary of a categorical variable, or a numeric variable with a finite number of values, like a ranking from 1 to 10.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">barplot</span>(<span class="kw">table</span>(mpg<span class="op">$</span>drv))</code></pre></div>
<p><img src="ScPoEconometrics_files/figure-html/unnamed-chunk-104-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">barplot</span>(<span class="kw">table</span>(mpg<span class="op">$</span>drv),
        <span class="dt">xlab   =</span> <span class="st">&quot;Drivetrain (f = FWD, r = RWD, 4 = 4WD)&quot;</span>,
        <span class="dt">ylab   =</span> <span class="st">&quot;Frequency&quot;</span>,
        <span class="dt">main   =</span> <span class="st">&quot;Drivetrains&quot;</span>,
        <span class="dt">col    =</span> <span class="st">&quot;dodgerblue&quot;</span>,
        <span class="dt">border =</span> <span class="st">&quot;darkorange&quot;</span>)</code></pre></div>
<p><img src="ScPoEconometrics_files/figure-html/unnamed-chunk-105-1.png" width="672" /></p>
</div>
<div id="boxplots" class="section level3">
<h3><span class="header-section-number">3.2.3</span> Boxplots</h3>
<p>To visualize the relationship between a numerical and categorical variable, once could use a <strong>boxplot</strong>. In the <code>mpg</code> dataset, the <code>drv</code> variable takes a small, finite number of values. A car can only be front wheel drive, 4 wheel drive, or rear wheel drive.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">unique</span>(mpg<span class="op">$</span>drv)</code></pre></div>
<pre><code>## [1] &quot;f&quot; &quot;4&quot; &quot;r&quot;</code></pre>
<p>First note that we can use a single boxplot as an alternative to a histogram for visualizing a single numerical variable. To do so in <code>R</code>, we use the <code>boxplot()</code> function. The box shows the <em>interquartile range</em>, the solid line in the middle is the value of the median, the wiskers show 1.5 times the interquartile range, and the dots are outliers.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">boxplot</span>(mpg<span class="op">$</span>hwy)</code></pre></div>
<p><img src="ScPoEconometrics_files/figure-html/unnamed-chunk-107-1.png" width="672" /></p>
<p>However, more often we will use boxplots to compare a numerical variable for different values of a categorical variable.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">boxplot</span>(hwy <span class="op">~</span><span class="st"> </span>drv, <span class="dt">data =</span> mpg)</code></pre></div>
<p><img src="ScPoEconometrics_files/figure-html/unnamed-chunk-108-1.png" width="672" /></p>
<p>Here used the <code>boxplot()</code> command to create side-by-side boxplots. However, since we are now dealing with two variables, the syntax has changed. The <code>R</code> syntax <code>hwy ~ drv, data = mpg</code> reads “Plot the <code>hwy</code> variable against the <code>drv</code> variable using the dataset <code>mpg</code>.” We see the use of a <code>~</code> (which specifies a formula) and also a <code>data =</code> argument. This will be a syntax that is common to many functions we will use in this course.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">boxplot</span>(hwy <span class="op">~</span><span class="st"> </span>drv, <span class="dt">data =</span> mpg,
     <span class="dt">xlab   =</span> <span class="st">&quot;Drivetrain (f = FWD, r = RWD, 4 = 4WD)&quot;</span>,
     <span class="dt">ylab   =</span> <span class="st">&quot;Miles Per Gallon (Highway)&quot;</span>,
     <span class="dt">main   =</span> <span class="st">&quot;MPG (Highway) vs Drivetrain&quot;</span>,
     <span class="dt">pch    =</span> <span class="dv">20</span>,
     <span class="dt">cex    =</span> <span class="dv">2</span>,
     <span class="dt">col    =</span> <span class="st">&quot;darkorange&quot;</span>,
     <span class="dt">border =</span> <span class="st">&quot;dodgerblue&quot;</span>)</code></pre></div>
<p><img src="ScPoEconometrics_files/figure-html/unnamed-chunk-109-1.png" width="672" /></p>
<p>Again, <code>boxplot()</code> has a number of additional arguments which have the ability to make our plot more visually appealing.</p>
</div>
<div id="scatterplots" class="section level3">
<h3><span class="header-section-number">3.2.4</span> Scatterplots</h3>
<p>Lastly, to visualize the relationship between two numeric variables we will use a <strong>scatterplot</strong>. This can be done with the <code>plot()</code> function and the <code>~</code> syntax we just used with a boxplot. (The function <code>plot()</code> can also be used more generally; see the documentation for details.)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(hwy <span class="op">~</span><span class="st"> </span>displ, <span class="dt">data =</span> mpg)</code></pre></div>
<p><img src="ScPoEconometrics_files/figure-html/unnamed-chunk-110-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(hwy <span class="op">~</span><span class="st"> </span>displ, <span class="dt">data =</span> mpg,
     <span class="dt">xlab =</span> <span class="st">&quot;Engine Displacement (in Liters)&quot;</span>,
     <span class="dt">ylab =</span> <span class="st">&quot;Miles Per Gallon (Highway)&quot;</span>,
     <span class="dt">main =</span> <span class="st">&quot;MPG (Highway) vs Engine Displacement&quot;</span>,
     <span class="dt">pch  =</span> <span class="dv">20</span>,
     <span class="dt">cex  =</span> <span class="dv">2</span>,
     <span class="dt">col  =</span> <span class="st">&quot;dodgerblue&quot;</span>)</code></pre></div>
<p><img src="ScPoEconometrics_files/figure-html/unnamed-chunk-111-1.png" width="672" /></p>
</div>
<div id="ggplot" class="section level3">
<h3><span class="header-section-number">3.2.5</span> <code>ggplot</code></h3>
<p>All of the above plots could also have been generated using the <code>ggplot</code> function from the already loaded <code>ggplot2</code> package. Which function you use is up to you, but sometimes a plot is easier to build in base R (like in the <code>boxplot</code> example maybe), sometimes the other way around.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg,<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x=</span>displ,<span class="dt">y=</span>hwy)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="ScPoEconometrics_files/figure-html/unnamed-chunk-112-1.png" width="672" /></p>
<p><code>ggplot</code> is impossible to describe in brief terms, so please look at <a href="http://ggplot2.tidyverse.org">the package’s website</a> which provides excellent guidance. We will from time to time use ggplot in this book, so try to familiarize yourself with it. Let’s quickly demonstrate how one could customize that first plot:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x=</span>displ,<span class="dt">y=</span>hwy)) <span class="op">+</span><span class="st">   </span><span class="co"># ggplot() makes base plot</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">color=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span><span class="st">     </span><span class="co"># how to show x and y?</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">name=</span><span class="st">&quot;Miles Per Gallon (Highway)&quot;</span>) <span class="op">+</span><span class="st">  </span><span class="co"># name of y axis</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">name=</span><span class="st">&quot;Engine Displacement (in Liters)&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co"># x axis</span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st">    </span><span class="co"># change the background</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;MPG (Highway) vs Engine Displacement&quot;</span>)   <span class="co"># add a title</span></code></pre></div>
<p><img src="ScPoEconometrics_files/figure-html/unnamed-chunk-113-1.png" width="672" /></p>
</div>
</div>
<div id="the-tidyverse" class="section level2">
<h2><span class="header-section-number">3.3</span> The <code>tidyverse</code></h2>
<p><a href="http://hadley.nz">Hadley Wickham</a> is the author of R packages <code>ggplot2</code> and also of <code>dplyr</code> (and also a myriad of others). With <code>ggplot2</code> he pioneered what he calls the <em>grammar of graphics</em> (hence, <code>gg</code>). Grammar in the sense that there are <strong>nouns</strong> and <strong>verbs</strong> and a <strong>syntax</strong>, i.e. rules of how nouns and verbs are to be put together to construct an understandable sentence. He has extended the <em>grammar</em> idea into various other packages. The <code>tidyverse</code> package is a collection of those packages.</p>
<p><code>tidy</code> data is data where:</p>
<ul>
<li>Each variable is a column</li>
<li>Each observation is a row</li>
<li>Each value is a cell</li>
</ul>
<p>Fair enough, you might say, that is a regular spreadsheet. And you are right! However, data comes to us <em>not</em> tidy most of the times, and we first need to clean, or <code>tidy</code>, it up. Once it’s in <code>tidy</code> format, we can use the tools in the <code>tidyverse</code> with great efficiency to analyse the data and stop worrying about which tool to use.</p>
</div>
<div id="example-importing-excel-data" class="section level2">
<h2><span class="header-section-number">3.4</span> Example: Importing Excel Data</h2>
<p>The data we will look at is from <a href="http://ec.europa.eu/eurostat/data/database">Eurostat</a> on demography and migration. You should download the data yourself (click on previous link, then drill down to <em>database by themes &gt; Population and social conditions &gt; Demograph and migration &gt; Population change - Demographic balance and crude rates at national level (demo_gind)</em>).</p>
<p>Once downloaded, we can read the data with the function <code>read_excel</code> from the package <a href="http://readxl.tidyverse.org"><code>readxl</code></a>, again part of the <code>tidyverse</code> suite.</p>
<p>It’s important to know how the data is organized in the spreadsheet. Open the file with Excel to see:</p>
<ul>
<li>There is a heading which we don’t need.</li>
<li>There are 5 rows with info that we don’t need.</li>
<li>There is one table per variable (total population, males, females, etc)</li>
<li>Each table has one row for each country, and one column for each year.</li>
<li>As such, this data is <strong>not tidy</strong>.</li>
</ul>
<p>Now we will read the first chunk of data, from the first table: <em>total population</em>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(readxl)  <span class="co"># load the library</span>

<span class="co"># Suppose I downloaded the file to a directory </span>
<span class="co"># data/ in my current working directory (cwd)</span>
<span class="co"># you can change your cwd with `setwd(&quot;your/directory&quot;)`</span>
<span class="co"># or in RStudio by clicking Session &gt; Set Working Directory</span>

<span class="co"># total population in raw format</span>
tot_pop_raw =<span class="st"> </span><span class="kw">read_excel</span>(<span class="dt">path =</span> <span class="st">&quot;data/demo_gind.xls&quot;</span>, 
                <span class="dt">sheet=</span><span class="st">&quot;Data&quot;</span>, <span class="co"># which sheet</span>
                <span class="dt">range=</span><span class="st">&quot;A9:K68&quot;</span>)  <span class="co"># which excel cell range to read</span>
<span class="kw">names</span>(tot_pop_raw)[<span class="dv">1</span>] &lt;-<span class="st"> &quot;Country&quot;</span>   <span class="co"># lets rename the first column</span>
tot_pop_raw</code></pre></div>
<pre><code>## # A tibble: 59 x 11
##    Country  `2008` `2009` `2010` `2011` `2012` `2013` `2014` `2015` `2016`
##    &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt; 
##  1 Europea… 50029… 50209… 50317… 50296… 50404… 50516… 50701… 50854… 51027…
##  2 Europea… 43872… 44004… 44066… 43994… 44055… 44125… 44266… 44366… 44489…
##  3 Europea… 49598… 49778… 49886… 49867… 49977… 50090… 50276… 50431… 50608…
##  4 Euro ar… 33309… 33447… 33526… 33457… 33528… 33604… 33754… 33856… 33988…
##  5 Euro ar… 32988… 33128… 33212… 33152… 33228… 33307… 33459… 33563… 33699…
##  6 Belgium  10666… 10753… 10839… 11000… 11075… 11137… 11180… 11237… 11311…
##  7 Bulgaria 75180… 74671… 74217… 73694… 73272… 72845… 72456… 72021… 71537…
##  8 Czech R… 10343… 10425… 10462… 10486… 10505… 10516… 10512… 10538… 10553…
##  9 Denmark  54757… 55114… 55347… 55606… 55805… 56026… 56272… 56597… 57072…
## 10 Germany… 82217… 82002… 81802… 80222… 80327… 80523… 80767… 81197… 82175…
## # ... with 49 more rows, and 1 more variable: `2017` &lt;chr&gt;</code></pre>
<p>This shows a <code>tibble</code>. This is more informative view of a <code>data.frame</code> (it tells us data type, and how many cols and rows). Notice, in particular, that <em>all</em> columns seem to be of type <code>chr</code>, i.e. characters - a string, not a number! We’ll have to fix that, as this is clearly numeric data.</p>
<div id="tidyr" class="section level3">
<h3><span class="header-section-number">3.4.1</span> <code>tidyr</code></h3>
<p>In the previous <code>tibble</code>, each year is a column name (like <code>2008</code>) instead of all years being in one column <code>year</code>. We really would like to have several rows for each Country, one per year. We want to <code>gather()</code> all years into a new column to tidy this up - and here is how:</p>
<ol style="list-style-type: decimal">
<li>specify which columns are to be gathered: in our case, all years (note that <code>paste(2008:2017)</code> produces a vector like <code>[&quot;2008&quot;, &quot;2009&quot;, &quot;2010&quot;,...]</code>)</li>
<li>say what those columns should be gathered into, i.e. what is the <em>key</em> for those values: <code>year</code>.</li>
<li>Finally, what is the name of the new resulting column, containing the <em>value</em> from each cell: <code>counts</code>.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyr)   <span class="co"># for the gather function</span>
tot_pop =<span class="st"> </span><span class="kw">gather</span>(tot_pop_raw, <span class="kw">paste</span>(<span class="dv">2008</span><span class="op">:</span><span class="dv">2017</span>),<span class="dt">key=</span><span class="st">&quot;year&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;counts&quot;</span>)</code></pre></div>
<p>Notice that <code>counts</code> is still a <code>chr</code>. Let’s convert it:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tot_pop<span class="op">$</span>counts =<span class="st"> </span><span class="kw">as.integer</span>(tot_pop<span class="op">$</span>counts)</code></pre></div>
<pre><code>## Warning: NAs introduced by coercion</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tot_pop</code></pre></div>
<pre><code>## # A tibble: 590 x 3
##    Country                                          year     counts
##    &lt;chr&gt;                                            &lt;chr&gt;     &lt;int&gt;
##  1 European Union (current composition)             2008  500297033
##  2 European Union (without United Kingdom)          2008  438725386
##  3 European Union (before the accession of Croatia) 2008  495985066
##  4 Euro area (19 countries)                         2008  333096775
##  5 Euro area (18 countries)                         2008  329884170
##  6 Belgium                                          2008   10666866
##  7 Bulgaria                                         2008    7518002
##  8 Czech Republic                                   2008   10343422
##  9 Denmark                                          2008    5475791
## 10 Germany (until 1990 former territory of the FRG) 2008   82217837
## # ... with 580 more rows</code></pre>
<p>Now you can see that column <code>counts</code> is indeed a <code>int</code>, i.e. an integer number, and we are fine.</p>
</div>
<div id="dplyr" class="section level3">
<h3><span class="header-section-number">3.4.2</span> <code>dplyr</code></h3>
<blockquote>
<p>The <a href="http://r4ds.had.co.nz/transform.html">transform</a> chapter of Hadley Wickham’s book is a great place to read up more on using <code>dplyr</code>.</p>
</blockquote>
<p>With <code>dplyr</code> you can do the following operations on <code>data.frame</code>s and <code>tibble</code>s:</p>
<ul>
<li>Choose observations based on a certain value: <code>filter()</code></li>
<li>Reorder rows: <code>arrange()</code></li>
<li>Select variables by name: <code>select()</code></li>
<li>Create new variables out of existing ones: <code>mutate()</code></li>
<li>Summarise variables: <code>summarise()</code></li>
</ul>
<p>All of those verbs can be used with <code>group_by()</code>, where we apply the respective operation on a <em>group</em> of the dataframe/tibble. For example, on our <code>tot_pop</code> tibble we will now</p>
<ul>
<li>filter</li>
<li>mutate</li>
<li>and plot the resulting values</li>
</ul>
<p>Now we can immediately select some countries and plot their population over time. We will make use of the <code>piping</code> syntax of <code>dplyr</code> as already mentioned in section <a href="R-intro.html#dataframes">2.6.7</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)  <span class="co"># for %&gt;%, filter, mutate, ...</span>
tot_pop <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(Country <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;France&quot;</span>,<span class="st">&quot;United Kingdom&quot;</span>,<span class="st">&quot;Italy&quot;</span>,<span class="st">&quot;Germany&quot;</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">millions =</span> counts <span class="op">/</span><span class="st"> </span><span class="fl">1e6</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x=</span>year,<span class="dt">y=</span>millions,<span class="dt">color=</span>Country,<span class="dt">group=</span>Country)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>()</code></pre></div>
<p><img src="ScPoEconometrics_files/figure-html/gather-plot-1.png" width="672" /></p>
<div id="arrange-a-tibble" class="section level4 unnumbered">
<h4>Arrange a <code>tibble</code></h4>
<ul>
<li>What are the top/bottom 5 most populated areas?</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">top5 =<span class="st"> </span>tot_pop <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(counts)) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># arrange in descending order of col `counts`</span>
<span class="st">  </span><span class="kw">top_n</span>(<span class="dv">5</span>)

bottom5 =<span class="st"> </span>tot_pop <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(counts)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">top_n</span>(<span class="op">-</span><span class="dv">5</span>)
top5</code></pre></div>
<pre><code>## # A tibble: 5 x 3
##   Country                                                   year    counts
##   &lt;chr&gt;                                                     &lt;chr&gt;    &lt;int&gt;
## 1 European Economic Area (EU28  - current composition, plu… 2017    5.17e8
## 2 European Economic Area (EU28  - current composition, plu… 2016    5.16e8
## 3 European Economic Area (EU28  - current composition, plu… 2015    5.14e8
## 4 European Economic Area (EU27 -  before the accession of … 2017    5.13e8
## 5 European Economic Area (EU28  - current composition, plu… 2014    5.12e8</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bottom5</code></pre></div>
<pre><code>## # A tibble: 5 x 3
##   Country    year  counts
##   &lt;chr&gt;      &lt;chr&gt;  &lt;int&gt;
## 1 San Marino 2015   32789
## 2 San Marino 2014   32520
## 3 San Marino 2008   32054
## 4 San Marino 2011   31863
## 5 San Marino 2009   31269</code></pre>
<p>Now this is not exactly what we wanted. It’s always the same country in both top and bottom, because there are multiple years per country. Let’s compute average population over the last 5 years and rank according to that:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">topbottom =<span class="st"> </span>tot_pop <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(Country) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(year <span class="op">&gt;</span><span class="st"> </span><span class="dv">2012</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean_count =</span> <span class="kw">mean</span>(counts)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(mean_count))

top5 =<span class="st"> </span>topbottom <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">top_n</span>(<span class="dv">5</span>)
bottom5 =<span class="st"> </span>topbottom <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">top_n</span>(<span class="op">-</span><span class="dv">5</span>)
top5</code></pre></div>
<pre><code>## # A tibble: 5 x 2
##   Country                                                       mean_count
##   &lt;chr&gt;                                                              &lt;dbl&gt;
## 1 European Economic Area (EU28  - current composition, plus IS… 514029320 
## 2 European Economic Area (EU27 -  before the accession of Croa… 509813491.
## 3 European Union (current composition)                          508502858.
## 4 European Union (before the accession of Croatia)              504287028.
## 5 European Union (without United Kingdom)                       443638309.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bottom5</code></pre></div>
<pre><code>## # A tibble: 5 x 2
##   Country       mean_count
##   &lt;chr&gt;              &lt;dbl&gt;
## 1 Luxembourg       563319.
## 2 Malta            440467.
## 3 Iceland          329501.
## 4 Liechtenstein     37353 
## 5 San Marino        33014.</code></pre>
<p>That’s better!</p>
</div>
<div id="look-for-nas-in-a-tibble" class="section level4 unnumbered">
<h4>Look for <code>NA</code>s in a <code>tibble</code></h4>
<p>Sometimes data is <em>missing</em>, and <code>R</code> represents it with the special value <code>NA</code> (not available). It is good to know where in our dataset we are going to encounter any missing values, so the task here is: let’s produce a table that has three columns:</p>
<ol style="list-style-type: decimal">
<li>the names of countries with missing data</li>
<li>how many years of data are missing for each of those</li>
<li>and the actual years that are missing</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">missings =<span class="st"> </span>tot_pop <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">is.na</span>(counts)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># is.na(x) returns TRUE if x is NA</span>
<span class="st">  </span><span class="kw">group_by</span>(Country) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">n_missing =</span> <span class="kw">n</span>(),<span class="dt">years =</span> <span class="kw">paste</span>(year,<span class="dt">collapse =</span> <span class="st">&quot;, &quot;</span>))
knitr<span class="op">:::</span><span class="kw">kable</span>(missings)</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Country</th>
<th align="right">n_missing</th>
<th align="left">years</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Albania</td>
<td align="right">2</td>
<td align="left">2010, 2012</td>
</tr>
<tr class="even">
<td align="left">Andorra</td>
<td align="right">2</td>
<td align="left">2014, 2015</td>
</tr>
<tr class="odd">
<td align="left">Armenia</td>
<td align="right">1</td>
<td align="left">2014</td>
</tr>
<tr class="even">
<td align="left">France (metropolitan)</td>
<td align="right">4</td>
<td align="left">2014, 2015, 2016, 2017</td>
</tr>
<tr class="odd">
<td align="left">Georgia</td>
<td align="right">1</td>
<td align="left">2013</td>
</tr>
<tr class="even">
<td align="left">Monaco</td>
<td align="right">7</td>
<td align="left">2008, 2009, 2010, 2011, 2012, 2013, 2014</td>
</tr>
<tr class="odd">
<td align="left">Russia</td>
<td align="right">4</td>
<td align="left">2013, 2015, 2016, 2017</td>
</tr>
<tr class="even">
<td align="left">San Marino</td>
<td align="right">1</td>
<td align="left">2010</td>
</tr>
</tbody>
</table>
<p>Notice that I used the function <code>kable</code> from the <code>knitr</code> package to produce a nicely looking table here.</p>
<ul>
<li>plot different vars</li>
<li>make proportions and plot</li>
<li>make growth rates and plot</li>
<li>plot different vars by country</li>
</ul>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="R-intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="linreg.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/floswald/ScPoEconometrics/edit/master/03-SummaryStats.Rmd",
"text": "Edit"
},
"download": ["ScPoEconometrics.pdf", "ScPoEconometrics.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
