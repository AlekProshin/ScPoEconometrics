<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Introduction to Econometrics with R</title>
  <meta name="description" content="SciencesPo UG Econometrics online textbook. No Maths.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Introduction to Econometrics with R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://scpoecon.github.io/ScPoEconometrics/" />
  
  <meta property="og:description" content="SciencesPo UG Econometrics online textbook. No Maths." />
  <meta name="github-repo" content="ScPoEcon/ScPoEconometrics" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Introduction to Econometrics with R" />
  
  <meta name="twitter:description" content="SciencesPo UG Econometrics online textbook. No Maths." />
  

<meta name="author" content="Florian Oswald and Jean-Marc Robin">


<meta name="date" content="2018-07-02">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  <link rel="shortcut icon" href="favicon.gif" type="image/x-icon">
<link rel="prev" href="std-errors.html">
<link rel="next" href="categorical-vars.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.2/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.7.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotlyjs-1.29.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotlyjs-1.29.2/plotly-latest.min.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-41584331-4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-41584331-4');
</script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">ScPo 2nd Year Econometrics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="R-intro.html"><a href="R-intro.html"><i class="fa fa-check"></i><b>1</b> Introduction to <code>R</code></a></li>
<li class="chapter" data-level="2" data-path="sum.html"><a href="sum.html"><i class="fa fa-check"></i><b>2</b> Working With Data</a></li>
<li class="chapter" data-level="3" data-path="linreg.html"><a href="linreg.html"><i class="fa fa-check"></i><b>3</b> Linear Regression</a></li>
<li class="chapter" data-level="4" data-path="std-errors.html"><a href="std-errors.html"><i class="fa fa-check"></i><b>4</b> Standard Errors</a></li>
<li class="chapter" data-level="5" data-path="multiple-reg.html"><a href="multiple-reg.html"><i class="fa fa-check"></i><b>5</b> Multiple Regression</a></li>
<li class="chapter" data-level="6" data-path="categorical-vars.html"><a href="categorical-vars.html"><i class="fa fa-check"></i><b>6</b> Categorial Variables</a></li>
<li class="chapter" data-level="7" data-path="quantreg.html"><a href="quantreg.html"><i class="fa fa-check"></i><b>7</b> Quantile Regression</a></li>
<li class="chapter" data-level="8" data-path="panel-data.html"><a href="panel-data.html"><i class="fa fa-check"></i><b>8</b> Panel Data</a></li>
<li class="chapter" data-level="9" data-path="IV.html"><a href="IV.html"><i class="fa fa-check"></i><b>9</b> Instrumental Variables</a></li>
<li class="chapter" data-level="10" data-path="logit-probit.html"><a href="logit-probit.html"><i class="fa fa-check"></i><b>10</b> Logit and Probit</a></li>
<li class="chapter" data-level="11" data-path="pca.html"><a href="pca.html"><i class="fa fa-check"></i><b>11</b> Principal Component Analysis</a></li>
<li class="chapter" data-level="12" data-path="notes.html"><a href="notes.html"><i class="fa fa-check"></i><b>12</b> Notes</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Econometrics with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="multiple-reg" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Multiple Regression</h1>
<p>We can extend the discussion from chapter <a href="linreg.html#linreg">3</a> to more than one explanatory variable. For example, suppose that instead of only <span class="math inline">\(x\)</span> we now had <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> in order to explain <span class="math inline">\(y\)</span>. Everything we’ve learned for the single variable case applies here as well. Instead of a regression <em>line</em>, we now get a regression <em>plane</em>, i.e. an object representable in 3 dimenions: <span class="math inline">\((x_1,x_2,y)\)</span>. As an example, suppose we wanted to explain how many <em>miles per gallon</em> (<code>mpg</code>) a car can travel as a function of its <em>horse power</em> (<code>hp</code>) and its <em>weight</em> (<code>wt</code>). In other words we want to estimate the equation</p>
<p><span class="math display" id="eq:abline2d">\[
mpg_i = \beta_0 + \beta_1 hp_i + \beta_2 wt_i + \varepsilon_i \tag{5.1}
\]</span> on our built-in dataset of cars (<code>mtcars</code>):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">subset</span>(mtcars, <span class="dt">select =</span> <span class="kw">c</span>(mpg,hp,wt))</code></pre></div>
<pre><code>##                      mpg  hp    wt
## Mazda RX4           21.0 110 2.620
## Mazda RX4 Wag       21.0 110 2.875
## Datsun 710          22.8  93 2.320
## Hornet 4 Drive      21.4 110 3.215
## Hornet Sportabout   18.7 175 3.440
## Valiant             18.1 105 3.460
## Duster 360          14.3 245 3.570
## Merc 240D           24.4  62 3.190
## Merc 230            22.8  95 3.150
## Merc 280            19.2 123 3.440
## Merc 280C           17.8 123 3.440
## Merc 450SE          16.4 180 4.070
## Merc 450SL          17.3 180 3.730
## Merc 450SLC         15.2 180 3.780
## Cadillac Fleetwood  10.4 205 5.250
## Lincoln Continental 10.4 215 5.424
## Chrysler Imperial   14.7 230 5.345
## Fiat 128            32.4  66 2.200
## Honda Civic         30.4  52 1.615
## Toyota Corolla      33.9  65 1.835
## Toyota Corona       21.5  97 2.465
## Dodge Challenger    15.5 150 3.520
## AMC Javelin         15.2 150 3.435
## Camaro Z28          13.3 245 3.840
## Pontiac Firebird    19.2 175 3.845
## Fiat X1-9           27.3  66 1.935
## Porsche 914-2       26.0  91 2.140
## Lotus Europa        30.4 113 1.513
## Ford Pantera L      15.8 264 3.170
## Ferrari Dino        19.7 175 2.770
## Maserati Bora       15.0 335 3.570
## Volvo 142E          21.4 109 2.780</code></pre>
<p>How do you think <code>hp</code> and <code>wt</code> will influence how many miles per gallon of gasoline each of those cars can travel? In other words, what do you expect the signs of <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_2\)</span> to be?</p>
<p>With two explanatory variables as here, it is still possible to visualize the regression plane, so let’s start with this as an answer. The OLS regression plane through this dataset looks like in figure <a href="multiple-reg.html#fig:plane3D-reg">5.1</a>:</p>
<div class="figure" style="text-align: center"><span id="fig:plane3D-reg"></span>
<div id="2c3750659f3" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="2c3750659f3">{"x":{"visdat":{"2c3777b4f7be":["function () ","plotlyVisDat"]},"cur_data":"2c3777b4f7be","attrs":{"2c3777b4f7be":{"colors":"grey","alpha":1,"sizes":[10,100],"x":{},"y":{},"z":{},"type":"scatter3d","mode":"markers","name":"data","opacity":0.8,"marker":{"color":"black","size":5,"hoverinfo":"skip"}},"2c3777b4f7be.1":{"z":{},"type":"surface","x":[1.513,5.424],"y":[52,335],"name":"Mtcars 3D","opacity":0.75,"cauto":false,"surfacecolor":[0,0,0]}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"wt"},"yaxis":{"title":"hp"},"zaxis":{"title":"mpg"}},"xaxis":{"domain":[0,1]},"yaxis":{"domain":[0,1]},"hovermode":"closest","showlegend":true,"legend":{"y":0.5,"yanchor":"top"}},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[2.62,2.875,2.32,3.215,3.44,3.46,3.57,3.19,3.15,3.44,3.44,4.07,3.73,3.78,5.25,5.424,5.345,2.2,1.615,1.835,2.465,3.52,3.435,3.84,3.845,1.935,2.14,1.513,3.17,2.77,3.57,2.78],"y":[110,110,93,110,175,105,245,62,95,123,123,180,180,180,205,215,230,66,52,65,97,150,150,245,175,66,91,113,264,175,335,109],"z":[21,21,22.8,21.4,18.7,18.1,14.3,24.4,22.8,19.2,17.8,16.4,17.3,15.2,10.4,10.4,14.7,32.4,30.4,33.9,21.5,15.5,15.2,13.3,19.2,27.3,26,30.4,15.8,19.7,15,21.4],"type":"scatter3d","mode":"markers","name":"data","opacity":0.8,"marker":{"fillcolor":"rgba(31,119,180,1)","color":"black","size":5,"hoverinfo":"skip","showscale":false},"frame":null},{"colorbar":{"title":"mpg<br />surf","ticklen":2,"len":0.5,"y":1,"lenmode":"fraction","yanchor":"top"},"colorscale":[["0","rgba(190,190,190,1)"],["0.0465258212464145","rgba(190,190,190,1)"],["0.093051642492829","rgba(190,190,190,1)"],["0.139577463739244","rgba(190,190,190,1)"],["0.186103284985658","rgba(190,190,190,1)"],["0.232629106232073","rgba(190,190,190,1)"],["0.279154927478487","rgba(190,190,190,1)"],["0.325680748724902","rgba(190,190,190,1)"],["0.372206569971316","rgba(190,190,190,1)"],["0.404154927478487","rgba(190,190,190,1)"],["0.436103284985658","rgba(190,190,190,1)"],["0.468051642492829","rgba(190,190,190,1)"],["0.5","rgba(190,190,190,1)"],["0.531948357507171","rgba(190,190,190,1)"],["0.563896715014342","rgba(190,190,190,1)"],["0.595845072521513","rgba(190,190,190,1)"],["0.627793430028684","rgba(190,190,190,1)"],["0.674319251275098","rgba(190,190,190,1)"],["0.720845072521513","rgba(190,190,190,1)"],["0.767370893767927","rgba(190,190,190,1)"],["0.813896715014342","rgba(190,190,190,1)"],["0.860422536260756","rgba(190,190,190,1)"],["0.906948357507171","rgba(190,190,190,1)"],["0.953474178753586","rgba(190,190,190,1)"],["1","rgba(190,190,190,1)"]],"showscale":false,"z":[[29.7079189601165,20.716174964165],[14.5417229265718,5.54997893062028]],"type":"surface","x":[1.513,5.424],"y":[52,335],"name":"Mtcars 3D","opacity":0.75,"cauto":false,"surfacecolor":[0,0,0],"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null},{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
<p class="caption">
Figure 5.1: Multiple Regression - a plane in 3D. The red lines indicate the residual for each observation.
</p>
</div>
<p>This visualization shows a couple of things: the data are shown with red points, the grey plane is the one resulting from OLS estimation of equation <a href="multiple-reg.html#eq:abline2d">(5.1)</a>, and the red lines show the size of the error between estimated plane and observed data. You should realize that this is exactly the same story as told in figure <a href="linreg.html#fig:line-arrows">3.1</a> - just in three dimensions!</p>
<p>We can see from this plot that cars with more horse power and greater weight, in general travel fewer miles per gallon of combustible. Hence, we observe a plane that is downward sloping in both the <em>weight</em> and <em>horse power</em> directions. Suppose now we wanted to know impact of <code>hp</code> on <code>mpg</code> <em>in isolation</em>, so as if we could ask</p>
<div class="tip">
<center>
Keeping the value of <span class="math inline"><span class="math inline">\(wt\)</span></span> fixed for a certain car, what would be the impact on <span class="math inline"><span class="math inline">\(mpg\)</span></span> be if we were to increase <strong>only</strong> its <span class="math inline"><span class="math inline">\(hp\)</span></span>? Put differently, keeping <strong>all else equal</strong>, what’s the impact of changing <span class="math inline"><span class="math inline">\(hp\)</span></span> on <span class="math inline"><span class="math inline">\(mpg\)</span></span>?
</center>
</div>
<p><br> We ask this kind of question all the time in econometrics. In figure <a href="multiple-reg.html#fig:plane3D-reg">5.1</a> you clearly see that both explanatory variables have a negative impact on the outcome of interest: as one increases either the horse power or the weight of a car, one finds that miles per gallon decreases. What is kind of hard to read off is <em>how negative</em> an impact each variable has in isolation.</p>
<p>As a matter of fact, the kind of question asked here is so common that it has got its own name: we’d say “<em>ceteris paribus</em>, what is the impact of <code>hp</code> on <code>mpg</code>?”. <em>ceteris paribus</em> is latin and means <em>the others equal</em>, i.e. all other variables fixed. In terms of our model in <a href="multiple-reg.html#eq:abline2d">(5.1)</a>, we want to know the following quantity:</p>
<p><span class="math display" id="eq:abline2d-deriv">\[
\frac{\partial mpg_i}{\partial hp_i} = \beta_1 \tag{5.2}
\]</span> This means: <em>keeping all other variables fixed, what is the effect of <code>hp</code> on <code>mpg</code>?</em>. In calculus, the answer to this is provided by the <em>partial derivative</em> as shown in <a href="multiple-reg.html#eq:abline2d-deriv">(5.2)</a>. We call the value of coefficient <span class="math inline">\(\beta_1\)</span> therefore also the <em>partial effect</em> of <code>hp</code> on <code>mpg</code>. In terms of our dataset, we use <code>R</code> to run the following <strong>multiple regression</strong>: <br></p>
<pre><code>## 
## Call:
## lm(formula = mpg ~ wt + hp, data = mtcars)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -3.941 -1.600 -0.182  1.050  5.854 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 37.22727    1.59879  23.285  &lt; 2e-16 ***
## wt          -3.87783    0.63273  -6.129 1.12e-06 ***
## hp          -0.03177    0.00903  -3.519  0.00145 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.593 on 29 degrees of freedom
## Multiple R-squared:  0.8268, Adjusted R-squared:  0.8148 
## F-statistic: 69.21 on 2 and 29 DF,  p-value: 9.109e-12</code></pre>
<p>From this table you see that the coefficient on <code>wt</code> has value -3.87783. You can interpret this as follows:</p>
<div class="warning">
<p>
Holding all other variables fixed at their observed values - or <em>ceteris paribus</em> - a one unit increase in <span class="math inline"><span class="math inline">\(wt\)</span></span> implies a -3.87783 units change in <span class="math inline"><span class="math inline">\(mpg\)</span></span>. Similarly, one more <span class="math inline"><span class="math inline">\(hp\)</span></span> horse power implies a change in <span class="math inline"><span class="math inline">\(mpg\)</span></span> of -0.03177 units, <em>all else (i.e. <span class="math inline"><span class="math inline">\(wt\)</span></span>) equal</em>.
</p>
</div>
<div id="california-test-scores-2" class="section level2">
<h2><span class="header-section-number">5.1</span> California Test Scores 2</h2>
<p>Let us extend our example of student test scores from chapter <a href="linreg.html#linreg">3</a> by adding families’ average income to our previous model:</p>
<p><span class="math display">\[
\text{testscr}_i = \beta_0 + \beta_1  \text{str}_i + \beta_2  \text{avginc}_i + \epsilon_i
\]</span></p>
<p>We can incoporate this new variable to our model by simply adding it to our <code>formula</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;Ecdat&quot;</span>) <span class="co"># reload the data</span>
fit_multivariate &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> <span class="st">&quot;testscr ~ str + avginc&quot;</span>, <span class="dt">data =</span> Caschool)
<span class="kw">summary</span>(fit_multivariate)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = &quot;testscr ~ str + avginc&quot;, data = Caschool)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -39.608  -9.052   0.707   9.259  31.898 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 638.72915    7.44908  85.746   &lt;2e-16 ***
## str          -0.64874    0.35440  -1.831   0.0679 .  
## avginc        1.83911    0.09279  19.821   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 13.35 on 417 degrees of freedom
## Multiple R-squared:  0.5115, Adjusted R-squared:  0.5091 
## F-statistic: 218.3 on 2 and 417 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Although it is quite cumbersome and not typical to visualize multivariate regressions, we can still do this with 2 explanatory variables using a <em>regression (2-dimensional) plane</em> [Interactive!].</p>
<div class="figure" style="text-align: center"><span id="fig:3D-Plotly"></span>
<div id="2c371dd5fa03" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="2c371dd5fa03">{"x":{"visdat":{"2c377d5130e":["function () ","plotlyVisDat"]},"cur_data":"2c377d5130e","attrs":{"2c377d5130e":{"colors":"grey","alpha":1,"sizes":[10,100],"x":{},"y":{},"z":{},"type":"scatter3d","mode":"markers","name":"Data","hoverinfo":"skip","opacity":0.6,"marker":{"color":"red","size":4}},"2c377d5130e.1":{"z":{},"type":"surface","x":[14,25.7999992370605],"y":[5.33500003814697,55.3279991149902],"name":"Best Fit Plane","opacity":0.75,"cauto":false,"surfacecolor":[0,0,0]}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"str"},"yaxis":{"title":"avginc"},"zaxis":{"title":"testscr"}},"xaxis":{"domain":[0,1]},"yaxis":{"domain":[0,1]},"hovermode":"closest","showlegend":true,"legend":{"y":0.5,"yanchor":"top"}},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[17.8899097442627,21.5246639251709,18.6972255706787,17.3571434020996,18.671329498291,21.40625,19.5,20.8941173553467,19.9473686218262,20.8055553436279,21.238094329834,21,20.6000003814697,20.0082168579102,18.0277786254883,20.2519607543945,16.9778690338135,16.5098037719727,22.7040233612061,19.911111831665,18.3333339691162,22.619047164917,19.4482765197754,25.0526313781738,20.6754379272461,18.68235206604,22.8455295562744,19.2666664123535,19.25,20.5454540252686,20.6069660186768,21.072681427002,21.5358142852783,19.9039993286133,21.1940689086914,21.8653545379639,18.3296451568604,16.2285709381104,19.1785717010498,20.2773666381836,22.9861373901367,20.4444446563721,19.8208465576172,23.2052230834961,19.2669677734375,23.301887512207,21.1882858276367,20.8717956542969,19.0174942016602,21.9193801879883,20.1012382507324,21.4765110015869,20.065788269043,20.3750953674316,22.4464817047119,22.8952388763428,20.4979705810547,20,22.2565803527832,21.5643634796143,19.4773712158203,17.6700210571289,21.9475612640381,21.7833938598633,19.1399993896484,18.1104965209961,20.6824245452881,22.623607635498,21.7864990234375,18.5829315185547,21.5454540252686,21.1528911590576,16.6333332061768,21.1443824768066,19.7818183898926,18.9837284088135,17.667667388916,17.7549915313721,15.2727270126343,14,20.596134185791,16.3116874694824,21.1279621124268,17.4880123138428,17.8867931365967,19.3067588806152,20.8923072814941,21.2868385314941,20.1955986022949,24.9500007629395,18.1304340362549,20,18.7295093536377,18.25,18.9925689697266,19.8876419067383,19.3789482116699,20.4625854492187,22.2915725708008,20.7047386169434,19.0600528717041,20.2324695587158,19.6901226043701,20.3625392913818,19.754222869873,19.3797664642334,22.9235095977783,19.3733978271484,19.1551551818848,21.2999992370605,18.3035717010498,21.0792560577393,18.7912082672119,19.6266174316406,19.5901641845703,20.8718719482422,21.1150016784668,20.0845203399658,19.9104881286621,17.8128509521484,18.1333332061768,19.2222118377686,18.6607151031494,19.6000003814697,19.283842086792,22.8181819915771,18.8092193603516,21.3736324310303,20.0204086303711,21.4986152648926,15.4285717010498,22.3999996185303,20.1270866394043,19.0379753112793,17.3421573638916,17.0186328887939,20.7999992370605,21.1538467407227,18.4583339691162,19.1408214569092,19.407657623291,19.5689640045166,21.50119972229,17.529411315918,16.4301719665527,19.7965393066406,17.1861343383789,17.615894317627,20.1253719329834,22.1666660308838,19.9615383148193,19.0394515991211,15.2243595123291,21.1447505950928,19.6438999176025,21.0486888885498,20.1754379272461,21.3913040161133,20.0083255767822,20.2913722991943,17.6666660308838,18.2205505371094,20.2710018157959,20.1989459991455,21.3842449188232,20.9736843109131,20,17.153284072876,22.3497714996338,22.1700706481934,18.1818180084229,18.9571437835693,19.7453308105469,16.4262294769287,16.6253967285156,16.3817672729492,20.0741577148437,17.9954433441162,19.3913040161133,16.4285717010498,16.7294864654541,24.4134521484375,18.2641506195068,18.955041885376,21.0389614105225,20.7407398223877,18.1000003814697,19.8461532592773,21.6000003814697,22.4424209594727,23.0143756866455,17.7489185333252,18.2866401672363,19.2654418945312,22.6666660308838,19.294116973877,17.3636360168457,19.8214282989502,20.4337787628174,21.0372085571289,19.9246234893799,19.0098571777344,23.8222217559814,19.3690853118896,19.8285713195801,15.2588548660278,17.1612911224365,21.8133335113525,19.0747127532959,25.7851238250732,18.2126140594482,18.1660633087158,16.972972869873,21.5008735656738,20.6000003814697,16.990291595459,20.7795448303223,15.5124664306641,19.8850574493408,21.3988227844238,20.4975128173828,19.3637580871582,17.659574508667,21.0179557800293,19.0556488037109,22.5384616851807,21.1078720092773,20.0513534545898,14.2017631530762,18.4768676757812,18.6354160308838,20.9459457397461,21.0854816436768,18.6928806304932,20.8680782318115,19.8255767822266,19.75,19.5,18.3908042907715,18.7867641448975,19.7701797485352,19.3333339691162,21.4639167785645,23.0849227905273,21.0629920959473,18.6868686676025,20.7702350616455,19.3055553436279,20.1328029632568,20.6696357727051,22.2815532684326,20.6002712249756,20.8273391723633,19.2249240875244,17.6547698974609,17,16.4977283477783,19.7826080322266,22.3021583557129,17.730770111084,20.4483604431152,20.3716945648193,20.1647872924805,21.6153774261475,20.5614280700684,19.9555110931396,21.1838703155518,18.8104228973389,20.5783824920654,18.3246078491211,18.8206272125244,20.8163261413574,20,19.6818180084229,19.3901767730713,20.927318572998,19.9443664550781,20.7910938262939,19.2035388946533,19.0243911743164,17.6205787658691,20.237154006958,19.2937393188477,18.8299808502197,20.3394927978516,19.2289962768555,17.8913040161133,19.5188102722168,19.0845069885254,19.9354839324951,18.8732566833496,20.1417846679687,23.5563716888428,21.4647884368896,19.191011428833,20.1308002471924,25.7999992370605,18.7777404785156,19.1098155975342,19.7010860443115,18.6159420013428,20.9972114562988,20,20.9832515716553,21.6426239013672,20.0296726226807,19.8113975524902,18,19.3581085205078,20.1791210174561,21.1198635101318,23.3897361755371,22.1818180084229,19.9428272247314,17.7882556915283,14.7058820724487,19.0407676696777,20.8919544219971,19.8385066986084,19.5219116210937,20.6862182617187,18.1818180084229,18.8922424316406,24.8888893127441,18.5806446075439,18.0400009155273,17.7339897155762,21.4545459747314,19.9234256744385,20.3394203186035,22.5460758209229,21.103443145752,18.1974258422852,20.1076812744141,19.1598358154297,19.5454540252686,20.8888893127441,18.3915023803711,19.1799030303955,19.3977069854736,21.6782722473145,19.2888889312744,20.3492736816406,20.9641609191895,19.4603900909424,19.2857151031494,20.9197940826416,20.9002132415771,20.5957450866699,19.375,19.9512233734131,18.8497333526611,18.1178703308105,19.1834087371826,22,21.5841579437256,20.3888893127441,16.2931022644043,18.2777824401855,19.3747158050537,18.9090900421143,16.406925201416,15.5913972854614,18.7069416046143,18.3298530578613,17.9023513793945,18.9115657806396,20.3249664306641,20.0245685577393,24,17.6078433990479,19.3485336303711,19.6784648895264,18.7286052703857,15.8823528289795,20.0549125671387,17.9882526397705,16.9662933349609,19.2393741607666,19.195858001709,19.5990619659424,20.543478012085,18.5884838104248,15.6041860580444,15.2930402755737,17.655366897583,17.579761505127,22.3333339691162,18.75,18.102409362793,20.2564105987549,18.802074432373,18.7723045349121,20.4052104949951,18.6507930755615,20.7070713043213,22,17.6997756958008,21.4832897186279,16.7010307312012,19.5756721496582,17.2580642700195,17.3752555847168,17.3493118286133,16.2622852325439,17.7004547119141,20.1288146972656,18.2653942108154,14.5421361923218,19.1526107788086,17.3657417297363,15.1389846801758,17.8426609039307,15.4070415496826,18.8653392791748,16.4741344451904,17.8626251220703,21.885856628418,20.2000007629395,19.0364017486572],"y":[22.6900005340576,9.82400035858154,8.97799968719482,8.97799968719482,9.08033275604248,10.414999961853,6.5770001411438,8.17399978637695,7.38500022888184,11.6133327484131,8.93099975585938,7.38500022888184,5.33500003814697,8.2790002822876,9.63000011444092,7.4539999961853,6.21600008010864,7.76399993896484,7.02199983596802,5.69899988174438,7.94099998474121,9.63000011444092,7.40500020980835,9.63000011444092,8.01900005340576,8.52299976348877,7.98318147659302,7.30499982833862,8.93400001525879,8.55399990081787,6.61299991607666,12.4090003967285,8.12661552429199,11.4309997558594,11.722225189209,11.3325004577637,9.59799957275391,14.5579996109009,22.0599994659424,9.70899963378906,11.4829444885254,8.17800045013428,8.17399978637695,7.5,10.0504999160767,7.33199977874756,12.5815773010254,15.1770000457764,12.1091279983521,11.7849998474121,14.0620002746582,10.4720001220703,13.4051170349121,12.3017997741699,15.404070854187,13.7620000839233,14.1840000152588,8.86499977111816,12.9969997406006,11.5920000076294,8.2790002822876,10.9056425094604,13.4006252288818,11.081000328064,9.08199977874756,13.3900003433228,14.6016254425049,11.1160001754761,8.42300033569336,11.664999961853,7.30499982833862,13.7305994033813,11.1160001754761,10.3644285202026,6.98299980163574,14.4678001403809,14.6529998779297,10.628999710083,9.7810001373291,10.6560001373291,11.9379997253418,7.38500022888184,10.6759996414185,9.97200012207031,8.25800037384033,8.89599990844727,12.0620002746582,9.42889499664307,8.92033290863037,10.0979995727539,11.8299999237061,11.5530004501343,19.7070007324219,7.10500001907349,13.7250003814697,10.0979995727539,13.7620000839233,9.66499996185303,10.2639999389648,11.5692005157471,7.40500020980835,12.0769996643066,11.2829999923706,10.0349998474121,8.38399982452393,13.6300001144409,14.127667427063,11.2661247253418,13.3900003433228,11.9379997253418,8.25800037384033,14.2267274856567,10.4720001220703,14.2429008483887,14.0659999847412,15.9680004119873,10.2639999389648,10.6024703979492,10.5229997634888,11.2379999160767,10.0559997558594,11.1829996109009,7.38500022888184,13.5790004730225,9.63000011444092,15.2740001678467,14.0342502593994,10.2396669387817,9.48499965667725,15.0298748016357,9.7810001373291,13.1920003890991,12.2159996032715,14.076000213623,25.4873332977295,14.8669996261597,9.97200012207031,14.5780000686646,7.38500022888184,12.3430004119873,12.4313325881958,14.9060001373291,12.6698999404907,10.3330001831055,11.9720001220703,12.8269996643066,10.039999961853,13.335000038147,9.85400009155273,11.4259996414185,15.1309995651245,14.5780000686646,10.2679996490479,15.5928573608398,11.2379999160767,15.0513753890991,15.4131765365601,11.081000328064,10.0979995727539,14.2982997894287,11.8030004501343,9.97200012207031,15.4090003967285,15.2937994003296,15.5329284667969,16.2929992675781,12.875,16.6229991912842,12.5498828887939,14.2585716247559,18.326000213623,12.7491426467896,11.4259996414185,8.82999992370605,11.1759996414185,14.2279996871948,15.0270004272461,10.5209999084473,18.6259994506836,22.5289993286133,18.2983894348145,11.8857498168945,9.92599964141846,14.1969995498657,9.63000011444092,10.6389999389648,14.4750003814697,13.4670000076294,9.66499996185303,12.7080001831055,17.8229999542236,17.1560001373291,19.589635848999,14.1969995498657,11.9119997024536,13.3859996795654,11.5539999008179,19.0259990692139,16.4069995880127,14.0579996109009,19.068000793457,20.7700004577637,10.2639999389648,14.5780000686646,10.2019996643066,12.5019998550415,13.9060001373291,9.98600006103516,13.7119998931885,10.0979995727539,11.2910003662109,13.2250003814697,13.6300001144409,14.6230001449585,8.77600002288818,10.3380002975464,16.3229999542236,10.6563329696655,14.5780000686646,18.6305999755859,11.1160001754761,14.5976667404175,15.4930000305176,16.2719993591309,13.6300001144409,12.3940000534058,15.331000328064,12.6660003662109,13.7119998931885,17.7803344726563,10.5566673278809,10.5229997634888,13.2430000305176,22.4729995727539,15.6846542358398,23.4837493896484,11.6490001678467,16.3560009002686,14.0740003585815,13.4370002746582,18.3379993438721,11.4259996414185,15.7499170303345,15.7790002822876,14.0620002746582,12.173999786377,12.8999996185303,10.9709997177124,17.4351997375488,14.7600002288818,14.6029996871948,13.5223331451416,16.6690006256104,13.5222501754761,12.5179996490479,18.326000213623,11.4659996032715,10.0979995727539,15.3649997711182,10.3113327026367,16.9866256713867,9.61200046539307,21.1105003356934,16.4733123779297,18.3689994812012,16.6541118621826,18.5442218780518,14.1800003051758,18.0295543670654,13.5860004425049,12.6400003433228,11.1029996871948,7.5,15.5059995651245,22.8414001464844,19.8231258392334,16.3470001220703,16.2929992675781,13.2480001449585,14.0100002288818,14.1630001068115,15.7709999084473,14.4833326339722,14.2089996337891,15.1669998168945,12.5842504501343,10.5509996414185,16.9559993743896,17.7089996337891,16.2719993591309,17.9008007049561,11.8339996337891,18.6201992034912,12.4309997558594,15.1669998168945,20.8757495880127,10.6389999389648,25.0296192169189,16.7578010559082,15.2969999313354,17.3694458007812,22.0960006713867,22.8419990539551,18.3198757171631,25.0300006866455,21.9570007324219,18.7968330383301,10.6389999389648,17.507999420166,18.5930004119873,11.1160001754761,14.0976667404175,12.6400003433228,20.9364280700684,14.1800003051758,11.826000213623,18.6709995269775,17.3320007324219,17.507999420166,15.5719995498657,15.56725025177,15.7519998550415,20.4699993133545,9.70899963378906,11.1160001754761,16.3209991455078,21.9669990539551,8.93400001525879,19.9969997406006,18.8272304534912,18.1186656951904,23.6673755645752,22.1389999389648,20.5459995269775,9.48499965667725,11.8339996337891,18.798999786377,10.5509996414185,15.5190000534058,21.6317272186279,21.0957508087158,15.1669998168945,19.117000579834,17.6200008392334,15.1669998168945,10.6429996490479,20.7390556335449,21.5659999847412,17.6560001373291,17.7089996337891,27.8159999847412,18.5930004119873,14.2629995346069,22.757999420166,12.6400003433228,11.2379999160767,16.9559993743896,17.7089996337891,25.6219997406006,18.7259998321533,13.4429998397827,15.1800003051758,19.117000579834,13.7119998931885,17.507999420166,11.8339996337891,13.2729997634888,16.3560009002686,18.6259994506836,23.7329998016357,12.9340000152588,13.9060001373291,15.4280004501343,15.3809995651245,22.5289993286133,23.8060989379883,24.6030006408691,36.173999786377,33.4550018310547,20.4802227020264,20.1340007781982,19.3465003967285,36.173999786377,22.8633346557617,17.7089996337891,14.1770000457764,41.0929985046387,21.9570007324219,16.0639991760254,25.7369995117187,20.4740009307861,35.810001373291,13.5670003890991,20.0890007019043,18.2830009460449,25.2397155761719,25.0629997253418,30.6284999847412,27.4752159118652,30.8400001525879,34.1595001220703,43.2299995422363,27.9477500915527,49.9389991760254,55.3279991149902,35.4809989929199,34.3009986877441,38.6285705566406,35.3419990539551,31.0520000457764,40.2639999389648,35.810001373291,43.2299995422363,50.6769981384277,40.4020004272461,28.7169990539551,41.7341079711914,23.7329998016357,9.95199966430664,12.5019998550415],"z":[690.799987792969,661.200012207031,643.599975585938,647.700012207031,640.849975585937,605.550048828125,606.75,609,612.5,612.650024414062,615.75,616.299987792969,616.299987792969,616.299987792969,616.450012207031,617.349975585937,618.050048828125,618.300048828125,619.799987792969,620.299987792969,620.5,621.400024414062,621.75,622.050048828125,622.599975585937,623.099975585938,623.200012207031,623.450012207031,623.599975585937,624.150024414062,624.550048828125,624.950012207031,625.299987792969,625.849975585938,626.099975585937,626.800048828125,626.900024414062,627.099975585938,627.25,627.299987792969,628.25,628.400024414063,628.550048828125,628.650024414062,628.75,629.800048828125,630.349975585937,630.400024414062,630.549987792969,630.549987792969,631.050048828125,631.400024414062,631.849975585937,631.900024414062,631.950012207031,632,632.200012207031,632.25,632.449951171875,632.849975585937,632.950012207031,633.049987792969,633.150024414062,633.650024414062,633.900024414062,634,634.050048828125,634.099975585937,634.099975585937,634.150024414062,634.199951171875,634.400024414062,634.549987792969,634.700012207031,634.900024414062,634.949951171875,635.049987792969,635.199951171875,635.450012207031,635.599975585938,635.599975585938,635.75,635.950012207031,636.099975585937,636.5,636.599975585937,636.699951171875,636.900024414063,636.950012207031,637,637.099975585937,637.349975585938,637.650024414062,637.949951171875,637.950012207031,638,638.200012207031,638.300048828125,638.300048828125,638.349975585938,638.549987792969,638.700012207031,639.25,639.300048828125,639.349975585937,639.5,639.75,639.799987792969,639.849975585937,639.900024414062,640.099975585937,640.150024414062,640.5,640.75,640.900024414063,641.099975585938,641.449951171875,641.449951171875,641.549987792969,641.800048828125,642.199951171875,642.200012207031,642.400024414063,642.75,643.049987792969,643.199951171875,643.25,643.400024414063,643.400024414063,643.5,643.5,643.699951171875,643.700012207031,644.199951171875,644.200012207031,644.400024414062,644.450012207031,644.450012207031,644.5,644.549987792969,644.699951171875,644.950012207031,645.099975585937,645.25,645.549987792969,645.550048828125,645.599975585937,645.75,645.75,646,646.200012207031,646.349975585937,646.400024414062,646.5,646.549987792969,646.700012207031,646.900024414062,646.949951171875,647.049987792969,647.25,647.299987792969,647.599975585937,647.599975585937,648,648.200012207031,648.25,648.349975585938,648.700012207031,648.949951171875,649.150024414062,649.300048828125,649.5,649.699951171875,649.849975585938,650.449951171875,650.549987792969,650.599975585937,650.650024414062,650.900024414062,650.900024414062,651.150024414063,651.200012207031,651.349975585937,651.400024414062,651.450012207031,651.800048828125,651.849975585937,651.900024414062,652,652.099975585938,652.099975585938,652.299987792969,652.300048828125,652.349975585938,652.400024414063,652.400024414063,652.5,652.849975585937,653.099975585937,653.400024414063,653.5,653.549987792969,653.550048828125,653.699951171875,653.799987792969,653.849975585937,653.949951171875,654.099975585937,654.199951171875,654.199951171875,654.299987792969,654.599975585938,654.849975585938,654.849975585938,654.900024414063,655.049987792969,655.050048828125,655.050048828125,655.199951171875,655.300048828125,655.349975585937,655.349975585937,655.400024414062,655.549987792969,655.699951171875,655.799987792969,655.849975585937,656.400024414062,656.5,656.550048828125,656.650024414062,656.700012207031,656.800048828125,656.800048828125,657,657,657.150024414062,657.400024414063,657.5,657.550048828125,657.650024414062,657.75,657.799987792969,657.900024414062,658,658.349975585938,658.599975585938,658.799987792969,659.050048828125,659.150024414062,659.349975585937,659.400024414062,659.400024414062,659.799987792969,659.900024414063,660.050048828125,660.099975585937,660.199951171875,660.299987792969,660.75,660.949951171875,661.349975585937,661.450012207031,661.599975585937,661.599975585937,661.849975585937,661.849975585937,661.849975585937,661.900024414063,661.900024414063,661.950012207031,662.400024414063,662.400024414063,662.450012207031,662.5,662.550048828125,662.550048828125,662.650024414062,662.700012207031,662.75,662.900024414062,663.349975585938,663.449951171875,663.5,663.849975585937,663.849975585937,663.900024414062,664,664,664.150024414062,664.150024414062,664.299987792969,664.400024414062,664.449951171875,664.700012207031,664.75,664.949951171875,664.950012207031,665.099975585937,665.200012207031,665.349975585937,665.650024414062,665.900024414063,665.950012207031,666,666.050048828125,666.099975585938,666.150024414063,666.150024414063,666.449951171875,666.550048828125,666.599975585937,666.650024414062,666.650024414062,666.699951171875,666.849975585938,666.849975585938,667.150024414062,667.199951171875,667.450012207031,667.450012207031,667.599975585937,668,668.099975585937,668.400024414063,668.599975585938,668.650024414063,668.799987792969,668.900024414062,668.950012207031,669.099975585937,669.300048828125,669.300048828125,669.349975585937,669.349975585937,669.799987792969,669.849975585938,669.950012207031,670,670.699951171875,671.25,671.299987792969,671.599975585937,671.599975585937,671.650024414062,671.699951171875,671.75,671.900024414062,671.900024414062,671.949951171875,672.049987792969,672.050048828125,672.299987792969,672.349975585938,672.450012207031,672.550048828125,672.699951171875,673.049987792969,673.25,673.299987792969,673.549987792969,673.549987792969,673.900024414062,674.25,675.400024414062,675.700012207031,676.150024414063,676.549987792969,676.599975585937,676.849975585937,676.949951171875,677.25,677.950012207031,678.050048828125,678.400024414063,678.799987792969,679.400024414062,679.5,679.650024414062,679.75,679.800048828125,680.050048828125,680.450012207031,681.299987792969,681.299987792969,681.599975585937,681.900024414062,682.150024414062,682.450012207031,682.549987792969,682.650024414062,683.349975585938,683.400024414063,684.300048828125,684.349975585937,684.800048828125,684.950012207031,686.050048828125,686.699951171875,687.549987792969,689.099975585937,691.049987792969,691.349975585937,691.900024414062,693.950012207031,694.25,694.800048828125,695.199951171875,695.299987792969,696.550048828125,698.199951171875,698.25,698.449951171875,699.099975585937,700.300048828125,704.300048828125,706.75,645,672.200012207031,655.75],"type":"scatter3d","mode":"markers","name":"Data","hoverinfo":["skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip"],"opacity":0.6,"marker":{"fillcolor":"rgba(31,119,180,1)","color":"red","size":4,"showscale":false},"frame":null},{"colorbar":{"title":"testscr<br />surf","ticklen":2,"len":0.5,"y":1,"lenmode":"fraction","yanchor":"top"},"colorscale":[["0","rgba(190,190,190,1)"],["0.00960755049164308","rgba(190,190,190,1)"],["0.0192151009832862","rgba(190,190,190,1)"],["0.0288226514749281","rgba(190,190,190,1)"],["0.0384302019665712","rgba(190,190,190,1)"],["0.0480377524582143","rgba(190,190,190,1)"],["0.0576453029498562","rgba(190,190,190,1)"],["0.0672528534414993","rgba(190,190,190,1)"],["0.0768604039331424","rgba(190,190,190,1)"],["0.182645302949856","rgba(190,190,190,1)"],["0.288430201966571","rgba(190,190,190,1)"],["0.394215100983286","rgba(190,190,190,1)"],["0.5","rgba(190,190,190,1)"],["0.605784899016714","rgba(190,190,190,1)"],["0.71156979803343","rgba(190,190,190,1)"],["0.817354697050144","rgba(190,190,190,1)"],["0.923139596066858","rgba(190,190,190,1)"],["0.932747146558501","rgba(190,190,190,1)"],["0.942354697050144","rgba(190,190,190,1)"],["0.951962247541786","rgba(190,190,190,1)"],["0.961569798033429","rgba(190,190,190,1)"],["0.971177348525072","rgba(190,190,190,1)"],["0.980784899016714","rgba(190,190,190,1)"],["0.990392449508357","rgba(190,190,190,1)"],["1","rgba(190,190,190,1)"]],"showscale":false,"z":[[639.458457290512,631.803324850641],[731.40119382008,723.746061380209]],"type":"surface","x":[14,25.7999992370605],"y":[5.33500003814697,55.3279991149902],"name":"Best Fit Plane","opacity":0.75,"cauto":false,"surfacecolor":[0,0,0],"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null},{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
<p class="caption">
Figure 5.2: Californa Test Scores vs student/teach ratio and avg income.
</p>
</div>
<p>While you explore this plot, ask yourself the following question: if you could only choose one of the two explanatory variables in our model (that is, either <span class="math inline">\(str\)</span> or <span class="math inline">\(avginc\)</span>) to predict the value of a given school’s average test score, which one would you choose? Why? Discuss this with your classmates.</p>
</div>
<div id="mreg-interactions" class="section level2">
<h2><span class="header-section-number">5.2</span> Interactions</h2>
<p>Interactions allow that the <em>ceteris paribus</em> effect of a certain regressor, <code>str</code> say, depends also on the value of yet another regressor, <code>avginc</code> for example. To measure such an effect, we would reformulate our model like this:</p>
<p><span class="math display" id="eq:caschool-inter">\[
\text{testscr}_i = \beta_0 + \beta_1  \text{str}_i + \beta_2  \text{avginc}_i + \beta_3 (\text{str}_i \times  \text{avginc}_i)+ \epsilon_i \tag{5.3}
\]</span></p>
<p>The inclusion of the <em>product</em> of <code>str</code> and <code>avginc</code> amounts to having different slopes with respect to <code>str</code> for different values of <code>avginc</code> (and vice versa). This is easy to see if we take the partial derivative of <a href="multiple-reg.html#eq:caschool-inter">(5.3)</a> with respect to <code>str</code>:</p>
<p><span class="math display" id="eq:caschool-inter-deriv">\[
\frac{\partial \text{testscr}_i}{\partial \text{str}_i} = \beta_1 + \beta_3 \text{avginc}_i \tag{5.4}
\]</span></p>
<blockquote>
<p>You should go back to equation <a href="multiple-reg.html#eq:abline2d-deriv">(5.2)</a> to remind yourself of what a <em>partial effect</em> was, and how exactly the present <a href="multiple-reg.html#eq:caschool-inter-deriv">(5.4)</a> differs from what we saw there.</p>
</blockquote>
<p>Back in our <code>R</code> session, we can run the full interactions model like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lm_inter =<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> testscr <span class="op">~</span><span class="st"> </span>str <span class="op">+</span><span class="st"> </span>avginc <span class="op">+</span><span class="st"> </span>str<span class="op">*</span>avginc, <span class="dt">data =</span> Caschool)
<span class="co"># note that this would produce the same result:</span>
<span class="co"># lm(formula = testscr ~ str*avginc, data = Caschool)</span>
<span class="co"># R expands str*avginc for you in main effects + interactions</span>
<span class="kw">summary</span>(lm_inter)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = testscr ~ str + avginc + str * avginc, data = Caschool)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -41.346  -9.260   0.209   8.736  33.368 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 689.47473   14.40894  47.850  &lt; 2e-16 ***
## str          -3.40957    0.75980  -4.487 9.34e-06 ***
## avginc       -1.62388    0.85214  -1.906   0.0574 .  
## str:avginc    0.18988    0.04646   4.087 5.24e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 13.1 on 416 degrees of freedom
## Multiple R-squared:  0.5303, Adjusted R-squared:  0.527 
## F-statistic: 156.6 on 3 and 416 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>We see here that the regression now estimates and additional coefficient <span class="math inline">\(\beta_3\)</span> for us. We observe also that the estimate of <span class="math inline">\(\beta_2\)</span> changes signs and becomes negative, while the interaction effect <span class="math inline">\(\beta_3\)</span> is positive. This means that an increase in <code>str</code> reduces average student scores (more students per teacher make it harder to teach effectively); that an increase in average district income in isolation actually reduces scores; and that the interaction of both increases scores (more students per teacher are actually a good thing for student performance in richer areas).</p>
<p>Looking at our visualization may help understand this result better. Figure <a href="multiple-reg.html#fig:3D-Plotly-inter">5.3</a> shows a plane that is no longer actually a <em>plane</em>. It shows a curved surface. You can see that the surface became more flexible in that we could kind of <em>bend</em> it more. Which model do you like better to explain this data? Discuss with your neighbor and give some reasons for your choice (other than “<a href="multiple-reg.html#fig:3D-Plotly-inter">5.3</a> looks nicer” ;-) ). In particular, comparing both visualizations, can you explain why we observe this strange inversion of coefficient signs?</p>
<div class="figure"><span id="fig:3D-Plotly-inter"></span>
<div id="2c37224a4adb" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="2c37224a4adb">{"x":{"visdat":{"2c371b9dbc92":["function () ","plotlyVisDat"]},"cur_data":"2c371b9dbc92","attrs":{"2c371b9dbc92":{"colors":"blue","alpha":1,"sizes":[10,100],"x":{},"y":{},"z":{},"type":"scatter3d","mode":"markers","name":"Data","hoverinfo":"skip","opacity":0.6,"marker":{"color":"red","size":4}},"2c371b9dbc92.1":{"z":{},"type":"surface","x":[14,25.7999992370605],"y":[5.33500003814697,55.3279991149902],"name":"Best Fit Plane with Interaction","opacity":0.75,"cauto":false,"surfacecolor":[0,0,0]}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"str"},"yaxis":{"title":"avginc"},"zaxis":{"title":"testscr"}},"xaxis":{"domain":[0,1]},"yaxis":{"domain":[0,1]},"hovermode":"closest","showlegend":true,"legend":{"y":0.5,"yanchor":"top"}},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[17.8899097442627,21.5246639251709,18.6972255706787,17.3571434020996,18.671329498291,21.40625,19.5,20.8941173553467,19.9473686218262,20.8055553436279,21.238094329834,21,20.6000003814697,20.0082168579102,18.0277786254883,20.2519607543945,16.9778690338135,16.5098037719727,22.7040233612061,19.911111831665,18.3333339691162,22.619047164917,19.4482765197754,25.0526313781738,20.6754379272461,18.68235206604,22.8455295562744,19.2666664123535,19.25,20.5454540252686,20.6069660186768,21.072681427002,21.5358142852783,19.9039993286133,21.1940689086914,21.8653545379639,18.3296451568604,16.2285709381104,19.1785717010498,20.2773666381836,22.9861373901367,20.4444446563721,19.8208465576172,23.2052230834961,19.2669677734375,23.301887512207,21.1882858276367,20.8717956542969,19.0174942016602,21.9193801879883,20.1012382507324,21.4765110015869,20.065788269043,20.3750953674316,22.4464817047119,22.8952388763428,20.4979705810547,20,22.2565803527832,21.5643634796143,19.4773712158203,17.6700210571289,21.9475612640381,21.7833938598633,19.1399993896484,18.1104965209961,20.6824245452881,22.623607635498,21.7864990234375,18.5829315185547,21.5454540252686,21.1528911590576,16.6333332061768,21.1443824768066,19.7818183898926,18.9837284088135,17.667667388916,17.7549915313721,15.2727270126343,14,20.596134185791,16.3116874694824,21.1279621124268,17.4880123138428,17.8867931365967,19.3067588806152,20.8923072814941,21.2868385314941,20.1955986022949,24.9500007629395,18.1304340362549,20,18.7295093536377,18.25,18.9925689697266,19.8876419067383,19.3789482116699,20.4625854492187,22.2915725708008,20.7047386169434,19.0600528717041,20.2324695587158,19.6901226043701,20.3625392913818,19.754222869873,19.3797664642334,22.9235095977783,19.3733978271484,19.1551551818848,21.2999992370605,18.3035717010498,21.0792560577393,18.7912082672119,19.6266174316406,19.5901641845703,20.8718719482422,21.1150016784668,20.0845203399658,19.9104881286621,17.8128509521484,18.1333332061768,19.2222118377686,18.6607151031494,19.6000003814697,19.283842086792,22.8181819915771,18.8092193603516,21.3736324310303,20.0204086303711,21.4986152648926,15.4285717010498,22.3999996185303,20.1270866394043,19.0379753112793,17.3421573638916,17.0186328887939,20.7999992370605,21.1538467407227,18.4583339691162,19.1408214569092,19.407657623291,19.5689640045166,21.50119972229,17.529411315918,16.4301719665527,19.7965393066406,17.1861343383789,17.615894317627,20.1253719329834,22.1666660308838,19.9615383148193,19.0394515991211,15.2243595123291,21.1447505950928,19.6438999176025,21.0486888885498,20.1754379272461,21.3913040161133,20.0083255767822,20.2913722991943,17.6666660308838,18.2205505371094,20.2710018157959,20.1989459991455,21.3842449188232,20.9736843109131,20,17.153284072876,22.3497714996338,22.1700706481934,18.1818180084229,18.9571437835693,19.7453308105469,16.4262294769287,16.6253967285156,16.3817672729492,20.0741577148437,17.9954433441162,19.3913040161133,16.4285717010498,16.7294864654541,24.4134521484375,18.2641506195068,18.955041885376,21.0389614105225,20.7407398223877,18.1000003814697,19.8461532592773,21.6000003814697,22.4424209594727,23.0143756866455,17.7489185333252,18.2866401672363,19.2654418945312,22.6666660308838,19.294116973877,17.3636360168457,19.8214282989502,20.4337787628174,21.0372085571289,19.9246234893799,19.0098571777344,23.8222217559814,19.3690853118896,19.8285713195801,15.2588548660278,17.1612911224365,21.8133335113525,19.0747127532959,25.7851238250732,18.2126140594482,18.1660633087158,16.972972869873,21.5008735656738,20.6000003814697,16.990291595459,20.7795448303223,15.5124664306641,19.8850574493408,21.3988227844238,20.4975128173828,19.3637580871582,17.659574508667,21.0179557800293,19.0556488037109,22.5384616851807,21.1078720092773,20.0513534545898,14.2017631530762,18.4768676757812,18.6354160308838,20.9459457397461,21.0854816436768,18.6928806304932,20.8680782318115,19.8255767822266,19.75,19.5,18.3908042907715,18.7867641448975,19.7701797485352,19.3333339691162,21.4639167785645,23.0849227905273,21.0629920959473,18.6868686676025,20.7702350616455,19.3055553436279,20.1328029632568,20.6696357727051,22.2815532684326,20.6002712249756,20.8273391723633,19.2249240875244,17.6547698974609,17,16.4977283477783,19.7826080322266,22.3021583557129,17.730770111084,20.4483604431152,20.3716945648193,20.1647872924805,21.6153774261475,20.5614280700684,19.9555110931396,21.1838703155518,18.8104228973389,20.5783824920654,18.3246078491211,18.8206272125244,20.8163261413574,20,19.6818180084229,19.3901767730713,20.927318572998,19.9443664550781,20.7910938262939,19.2035388946533,19.0243911743164,17.6205787658691,20.237154006958,19.2937393188477,18.8299808502197,20.3394927978516,19.2289962768555,17.8913040161133,19.5188102722168,19.0845069885254,19.9354839324951,18.8732566833496,20.1417846679687,23.5563716888428,21.4647884368896,19.191011428833,20.1308002471924,25.7999992370605,18.7777404785156,19.1098155975342,19.7010860443115,18.6159420013428,20.9972114562988,20,20.9832515716553,21.6426239013672,20.0296726226807,19.8113975524902,18,19.3581085205078,20.1791210174561,21.1198635101318,23.3897361755371,22.1818180084229,19.9428272247314,17.7882556915283,14.7058820724487,19.0407676696777,20.8919544219971,19.8385066986084,19.5219116210937,20.6862182617187,18.1818180084229,18.8922424316406,24.8888893127441,18.5806446075439,18.0400009155273,17.7339897155762,21.4545459747314,19.9234256744385,20.3394203186035,22.5460758209229,21.103443145752,18.1974258422852,20.1076812744141,19.1598358154297,19.5454540252686,20.8888893127441,18.3915023803711,19.1799030303955,19.3977069854736,21.6782722473145,19.2888889312744,20.3492736816406,20.9641609191895,19.4603900909424,19.2857151031494,20.9197940826416,20.9002132415771,20.5957450866699,19.375,19.9512233734131,18.8497333526611,18.1178703308105,19.1834087371826,22,21.5841579437256,20.3888893127441,16.2931022644043,18.2777824401855,19.3747158050537,18.9090900421143,16.406925201416,15.5913972854614,18.7069416046143,18.3298530578613,17.9023513793945,18.9115657806396,20.3249664306641,20.0245685577393,24,17.6078433990479,19.3485336303711,19.6784648895264,18.7286052703857,15.8823528289795,20.0549125671387,17.9882526397705,16.9662933349609,19.2393741607666,19.195858001709,19.5990619659424,20.543478012085,18.5884838104248,15.6041860580444,15.2930402755737,17.655366897583,17.579761505127,22.3333339691162,18.75,18.102409362793,20.2564105987549,18.802074432373,18.7723045349121,20.4052104949951,18.6507930755615,20.7070713043213,22,17.6997756958008,21.4832897186279,16.7010307312012,19.5756721496582,17.2580642700195,17.3752555847168,17.3493118286133,16.2622852325439,17.7004547119141,20.1288146972656,18.2653942108154,14.5421361923218,19.1526107788086,17.3657417297363,15.1389846801758,17.8426609039307,15.4070415496826,18.8653392791748,16.4741344451904,17.8626251220703,21.885856628418,20.2000007629395,19.0364017486572],"y":[22.6900005340576,9.82400035858154,8.97799968719482,8.97799968719482,9.08033275604248,10.414999961853,6.5770001411438,8.17399978637695,7.38500022888184,11.6133327484131,8.93099975585938,7.38500022888184,5.33500003814697,8.2790002822876,9.63000011444092,7.4539999961853,6.21600008010864,7.76399993896484,7.02199983596802,5.69899988174438,7.94099998474121,9.63000011444092,7.40500020980835,9.63000011444092,8.01900005340576,8.52299976348877,7.98318147659302,7.30499982833862,8.93400001525879,8.55399990081787,6.61299991607666,12.4090003967285,8.12661552429199,11.4309997558594,11.722225189209,11.3325004577637,9.59799957275391,14.5579996109009,22.0599994659424,9.70899963378906,11.4829444885254,8.17800045013428,8.17399978637695,7.5,10.0504999160767,7.33199977874756,12.5815773010254,15.1770000457764,12.1091279983521,11.7849998474121,14.0620002746582,10.4720001220703,13.4051170349121,12.3017997741699,15.404070854187,13.7620000839233,14.1840000152588,8.86499977111816,12.9969997406006,11.5920000076294,8.2790002822876,10.9056425094604,13.4006252288818,11.081000328064,9.08199977874756,13.3900003433228,14.6016254425049,11.1160001754761,8.42300033569336,11.664999961853,7.30499982833862,13.7305994033813,11.1160001754761,10.3644285202026,6.98299980163574,14.4678001403809,14.6529998779297,10.628999710083,9.7810001373291,10.6560001373291,11.9379997253418,7.38500022888184,10.6759996414185,9.97200012207031,8.25800037384033,8.89599990844727,12.0620002746582,9.42889499664307,8.92033290863037,10.0979995727539,11.8299999237061,11.5530004501343,19.7070007324219,7.10500001907349,13.7250003814697,10.0979995727539,13.7620000839233,9.66499996185303,10.2639999389648,11.5692005157471,7.40500020980835,12.0769996643066,11.2829999923706,10.0349998474121,8.38399982452393,13.6300001144409,14.127667427063,11.2661247253418,13.3900003433228,11.9379997253418,8.25800037384033,14.2267274856567,10.4720001220703,14.2429008483887,14.0659999847412,15.9680004119873,10.2639999389648,10.6024703979492,10.5229997634888,11.2379999160767,10.0559997558594,11.1829996109009,7.38500022888184,13.5790004730225,9.63000011444092,15.2740001678467,14.0342502593994,10.2396669387817,9.48499965667725,15.0298748016357,9.7810001373291,13.1920003890991,12.2159996032715,14.076000213623,25.4873332977295,14.8669996261597,9.97200012207031,14.5780000686646,7.38500022888184,12.3430004119873,12.4313325881958,14.9060001373291,12.6698999404907,10.3330001831055,11.9720001220703,12.8269996643066,10.039999961853,13.335000038147,9.85400009155273,11.4259996414185,15.1309995651245,14.5780000686646,10.2679996490479,15.5928573608398,11.2379999160767,15.0513753890991,15.4131765365601,11.081000328064,10.0979995727539,14.2982997894287,11.8030004501343,9.97200012207031,15.4090003967285,15.2937994003296,15.5329284667969,16.2929992675781,12.875,16.6229991912842,12.5498828887939,14.2585716247559,18.326000213623,12.7491426467896,11.4259996414185,8.82999992370605,11.1759996414185,14.2279996871948,15.0270004272461,10.5209999084473,18.6259994506836,22.5289993286133,18.2983894348145,11.8857498168945,9.92599964141846,14.1969995498657,9.63000011444092,10.6389999389648,14.4750003814697,13.4670000076294,9.66499996185303,12.7080001831055,17.8229999542236,17.1560001373291,19.589635848999,14.1969995498657,11.9119997024536,13.3859996795654,11.5539999008179,19.0259990692139,16.4069995880127,14.0579996109009,19.068000793457,20.7700004577637,10.2639999389648,14.5780000686646,10.2019996643066,12.5019998550415,13.9060001373291,9.98600006103516,13.7119998931885,10.0979995727539,11.2910003662109,13.2250003814697,13.6300001144409,14.6230001449585,8.77600002288818,10.3380002975464,16.3229999542236,10.6563329696655,14.5780000686646,18.6305999755859,11.1160001754761,14.5976667404175,15.4930000305176,16.2719993591309,13.6300001144409,12.3940000534058,15.331000328064,12.6660003662109,13.7119998931885,17.7803344726563,10.5566673278809,10.5229997634888,13.2430000305176,22.4729995727539,15.6846542358398,23.4837493896484,11.6490001678467,16.3560009002686,14.0740003585815,13.4370002746582,18.3379993438721,11.4259996414185,15.7499170303345,15.7790002822876,14.0620002746582,12.173999786377,12.8999996185303,10.9709997177124,17.4351997375488,14.7600002288818,14.6029996871948,13.5223331451416,16.6690006256104,13.5222501754761,12.5179996490479,18.326000213623,11.4659996032715,10.0979995727539,15.3649997711182,10.3113327026367,16.9866256713867,9.61200046539307,21.1105003356934,16.4733123779297,18.3689994812012,16.6541118621826,18.5442218780518,14.1800003051758,18.0295543670654,13.5860004425049,12.6400003433228,11.1029996871948,7.5,15.5059995651245,22.8414001464844,19.8231258392334,16.3470001220703,16.2929992675781,13.2480001449585,14.0100002288818,14.1630001068115,15.7709999084473,14.4833326339722,14.2089996337891,15.1669998168945,12.5842504501343,10.5509996414185,16.9559993743896,17.7089996337891,16.2719993591309,17.9008007049561,11.8339996337891,18.6201992034912,12.4309997558594,15.1669998168945,20.8757495880127,10.6389999389648,25.0296192169189,16.7578010559082,15.2969999313354,17.3694458007812,22.0960006713867,22.8419990539551,18.3198757171631,25.0300006866455,21.9570007324219,18.7968330383301,10.6389999389648,17.507999420166,18.5930004119873,11.1160001754761,14.0976667404175,12.6400003433228,20.9364280700684,14.1800003051758,11.826000213623,18.6709995269775,17.3320007324219,17.507999420166,15.5719995498657,15.56725025177,15.7519998550415,20.4699993133545,9.70899963378906,11.1160001754761,16.3209991455078,21.9669990539551,8.93400001525879,19.9969997406006,18.8272304534912,18.1186656951904,23.6673755645752,22.1389999389648,20.5459995269775,9.48499965667725,11.8339996337891,18.798999786377,10.5509996414185,15.5190000534058,21.6317272186279,21.0957508087158,15.1669998168945,19.117000579834,17.6200008392334,15.1669998168945,10.6429996490479,20.7390556335449,21.5659999847412,17.6560001373291,17.7089996337891,27.8159999847412,18.5930004119873,14.2629995346069,22.757999420166,12.6400003433228,11.2379999160767,16.9559993743896,17.7089996337891,25.6219997406006,18.7259998321533,13.4429998397827,15.1800003051758,19.117000579834,13.7119998931885,17.507999420166,11.8339996337891,13.2729997634888,16.3560009002686,18.6259994506836,23.7329998016357,12.9340000152588,13.9060001373291,15.4280004501343,15.3809995651245,22.5289993286133,23.8060989379883,24.6030006408691,36.173999786377,33.4550018310547,20.4802227020264,20.1340007781982,19.3465003967285,36.173999786377,22.8633346557617,17.7089996337891,14.1770000457764,41.0929985046387,21.9570007324219,16.0639991760254,25.7369995117187,20.4740009307861,35.810001373291,13.5670003890991,20.0890007019043,18.2830009460449,25.2397155761719,25.0629997253418,30.6284999847412,27.4752159118652,30.8400001525879,34.1595001220703,43.2299995422363,27.9477500915527,49.9389991760254,55.3279991149902,35.4809989929199,34.3009986877441,38.6285705566406,35.3419990539551,31.0520000457764,40.2639999389648,35.810001373291,43.2299995422363,50.6769981384277,40.4020004272461,28.7169990539551,41.7341079711914,23.7329998016357,9.95199966430664,12.5019998550415],"z":[690.799987792969,661.200012207031,643.599975585938,647.700012207031,640.849975585937,605.550048828125,606.75,609,612.5,612.650024414062,615.75,616.299987792969,616.299987792969,616.299987792969,616.450012207031,617.349975585937,618.050048828125,618.300048828125,619.799987792969,620.299987792969,620.5,621.400024414062,621.75,622.050048828125,622.599975585937,623.099975585938,623.200012207031,623.450012207031,623.599975585937,624.150024414062,624.550048828125,624.950012207031,625.299987792969,625.849975585938,626.099975585937,626.800048828125,626.900024414062,627.099975585938,627.25,627.299987792969,628.25,628.400024414063,628.550048828125,628.650024414062,628.75,629.800048828125,630.349975585937,630.400024414062,630.549987792969,630.549987792969,631.050048828125,631.400024414062,631.849975585937,631.900024414062,631.950012207031,632,632.200012207031,632.25,632.449951171875,632.849975585937,632.950012207031,633.049987792969,633.150024414062,633.650024414062,633.900024414062,634,634.050048828125,634.099975585937,634.099975585937,634.150024414062,634.199951171875,634.400024414062,634.549987792969,634.700012207031,634.900024414062,634.949951171875,635.049987792969,635.199951171875,635.450012207031,635.599975585938,635.599975585938,635.75,635.950012207031,636.099975585937,636.5,636.599975585937,636.699951171875,636.900024414063,636.950012207031,637,637.099975585937,637.349975585938,637.650024414062,637.949951171875,637.950012207031,638,638.200012207031,638.300048828125,638.300048828125,638.349975585938,638.549987792969,638.700012207031,639.25,639.300048828125,639.349975585937,639.5,639.75,639.799987792969,639.849975585937,639.900024414062,640.099975585937,640.150024414062,640.5,640.75,640.900024414063,641.099975585938,641.449951171875,641.449951171875,641.549987792969,641.800048828125,642.199951171875,642.200012207031,642.400024414063,642.75,643.049987792969,643.199951171875,643.25,643.400024414063,643.400024414063,643.5,643.5,643.699951171875,643.700012207031,644.199951171875,644.200012207031,644.400024414062,644.450012207031,644.450012207031,644.5,644.549987792969,644.699951171875,644.950012207031,645.099975585937,645.25,645.549987792969,645.550048828125,645.599975585937,645.75,645.75,646,646.200012207031,646.349975585937,646.400024414062,646.5,646.549987792969,646.700012207031,646.900024414062,646.949951171875,647.049987792969,647.25,647.299987792969,647.599975585937,647.599975585937,648,648.200012207031,648.25,648.349975585938,648.700012207031,648.949951171875,649.150024414062,649.300048828125,649.5,649.699951171875,649.849975585938,650.449951171875,650.549987792969,650.599975585937,650.650024414062,650.900024414062,650.900024414062,651.150024414063,651.200012207031,651.349975585937,651.400024414062,651.450012207031,651.800048828125,651.849975585937,651.900024414062,652,652.099975585938,652.099975585938,652.299987792969,652.300048828125,652.349975585938,652.400024414063,652.400024414063,652.5,652.849975585937,653.099975585937,653.400024414063,653.5,653.549987792969,653.550048828125,653.699951171875,653.799987792969,653.849975585937,653.949951171875,654.099975585937,654.199951171875,654.199951171875,654.299987792969,654.599975585938,654.849975585938,654.849975585938,654.900024414063,655.049987792969,655.050048828125,655.050048828125,655.199951171875,655.300048828125,655.349975585937,655.349975585937,655.400024414062,655.549987792969,655.699951171875,655.799987792969,655.849975585937,656.400024414062,656.5,656.550048828125,656.650024414062,656.700012207031,656.800048828125,656.800048828125,657,657,657.150024414062,657.400024414063,657.5,657.550048828125,657.650024414062,657.75,657.799987792969,657.900024414062,658,658.349975585938,658.599975585938,658.799987792969,659.050048828125,659.150024414062,659.349975585937,659.400024414062,659.400024414062,659.799987792969,659.900024414063,660.050048828125,660.099975585937,660.199951171875,660.299987792969,660.75,660.949951171875,661.349975585937,661.450012207031,661.599975585937,661.599975585937,661.849975585937,661.849975585937,661.849975585937,661.900024414063,661.900024414063,661.950012207031,662.400024414063,662.400024414063,662.450012207031,662.5,662.550048828125,662.550048828125,662.650024414062,662.700012207031,662.75,662.900024414062,663.349975585938,663.449951171875,663.5,663.849975585937,663.849975585937,663.900024414062,664,664,664.150024414062,664.150024414062,664.299987792969,664.400024414062,664.449951171875,664.700012207031,664.75,664.949951171875,664.950012207031,665.099975585937,665.200012207031,665.349975585937,665.650024414062,665.900024414063,665.950012207031,666,666.050048828125,666.099975585938,666.150024414063,666.150024414063,666.449951171875,666.550048828125,666.599975585937,666.650024414062,666.650024414062,666.699951171875,666.849975585938,666.849975585938,667.150024414062,667.199951171875,667.450012207031,667.450012207031,667.599975585937,668,668.099975585937,668.400024414063,668.599975585938,668.650024414063,668.799987792969,668.900024414062,668.950012207031,669.099975585937,669.300048828125,669.300048828125,669.349975585937,669.349975585937,669.799987792969,669.849975585938,669.950012207031,670,670.699951171875,671.25,671.299987792969,671.599975585937,671.599975585937,671.650024414062,671.699951171875,671.75,671.900024414062,671.900024414062,671.949951171875,672.049987792969,672.050048828125,672.299987792969,672.349975585938,672.450012207031,672.550048828125,672.699951171875,673.049987792969,673.25,673.299987792969,673.549987792969,673.549987792969,673.900024414062,674.25,675.400024414062,675.700012207031,676.150024414063,676.549987792969,676.599975585937,676.849975585937,676.949951171875,677.25,677.950012207031,678.050048828125,678.400024414063,678.799987792969,679.400024414062,679.5,679.650024414062,679.75,679.800048828125,680.050048828125,680.450012207031,681.299987792969,681.299987792969,681.599975585937,681.900024414062,682.150024414062,682.450012207031,682.549987792969,682.650024414062,683.349975585938,683.400024414063,684.300048828125,684.349975585937,684.800048828125,684.950012207031,686.050048828125,686.699951171875,687.549987792969,689.099975585937,691.049987792969,691.349975585937,691.900024414062,693.950012207031,694.25,694.800048828125,695.199951171875,695.299987792969,696.550048828125,698.199951171875,698.25,698.449951171875,699.099975585937,700.300048828125,704.300048828125,706.75,645,672.200012207031,655.75],"type":"scatter3d","mode":"markers","name":"Data","hoverinfo":["skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip","skip"],"opacity":0.6,"marker":{"fillcolor":"rgba(31,119,180,1)","color":"red","size":4,"showscale":false},"frame":null},{"colorbar":{"title":"testscr<br />surf","ticklen":2,"len":0.5,"y":1,"lenmode":"fraction","yanchor":"top"},"colorscale":[["0","rgba(0,0,255,1)"],["0.0215899876940638","rgba(0,0,255,1)"],["0.0431799753881262","rgba(0,0,255,1)"],["0.0647699630821899","rgba(0,0,255,1)"],["0.086359950776253","rgba(0,0,255,1)"],["0.107949938470316","rgba(0,0,255,1)"],["0.12953992616438","rgba(0,0,255,1)"],["0.151129913858442","rgba(0,0,255,1)"],["0.172719901552506","rgba(0,0,255,1)"],["0.212202234840912","rgba(0,0,255,1)"],["0.251684568129317","rgba(0,0,255,1)"],["0.291166901417723","rgba(0,0,255,1)"],["0.330649234706129","rgba(0,0,255,1)"],["0.370131567994534","rgba(0,0,255,1)"],["0.40961390128294","rgba(0,0,255,1)"],["0.449096234571345","rgba(0,0,255,1)"],["0.488578567859751","rgba(0,0,255,1)"],["0.552506246877282","rgba(0,0,255,1)"],["0.616433925894813","rgba(0,0,255,1)"],["0.680361604912344","rgba(0,0,255,1)"],["0.744289283929875","rgba(0,0,255,1)"],["0.808216962947406","rgba(0,0,255,1)"],["0.872144641964938","rgba(0,0,255,1)"],["0.936072320982469","rgba(0,0,255,1)"],["1","rgba(0,0,255,1)"]],"showscale":false,"z":[[647.259542000998,618.980191889216],[698.974936289987,782.709732362498]],"type":"surface","x":[14,25.7999992370605],"y":[5.33500003814697,55.3279991149902],"name":"Best Fit Plane with Interaction","opacity":0.75,"cauto":false,"surfacecolor":[0,0,0],"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null},{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
<p class="caption">
Figure 5.3: Californa Test Scores vs student/teach ratio and avg income plus interaction term
</p>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="std-errors.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="categorical-vars.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ScPoEcon/ScPoEconometrics/edit/master/06-MultipleReg.Rmd",
"text": "Edit"
},
"download": ["ScPoEconometrics.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
