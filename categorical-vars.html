<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Introduction to Econometrics with R</title>
  <meta name="description" content="SciencesPo UG Econometrics online textbook. No Maths.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Introduction to Econometrics with R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://scpoecon.github.io/ScPoEconometrics/" />
  
  <meta property="og:description" content="SciencesPo UG Econometrics online textbook. No Maths." />
  <meta name="github-repo" content="ScPoEcon/ScPoEconometrics" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Introduction to Econometrics with R" />
  
  <meta name="twitter:description" content="SciencesPo UG Econometrics online textbook. No Maths." />
  

<meta name="author" content="Florian Oswald and Jean-Marc Robin">


<meta name="date" content="2018-06-28">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  <link rel="shortcut icon" href="favicon.gif" type="image/x-icon">
<link rel="prev" href="multiple-reg.html">
<link rel="next" href="quantreg.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.2/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.7.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotlyjs-1.29.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotlyjs-1.29.2/plotly-latest.min.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-41584331-4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-41584331-4');
</script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">ScPo 2nd Year Econometrics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="R-intro.html"><a href="R-intro.html"><i class="fa fa-check"></i><b>1</b> Introduction to <code>R</code></a></li>
<li class="chapter" data-level="2" data-path="sum.html"><a href="sum.html"><i class="fa fa-check"></i><b>2</b> Working With Data</a></li>
<li class="chapter" data-level="3" data-path="linreg.html"><a href="linreg.html"><i class="fa fa-check"></i><b>3</b> Linear Regression</a></li>
<li class="chapter" data-level="4" data-path="std-errors.html"><a href="std-errors.html"><i class="fa fa-check"></i><b>4</b> Standard Errors</a></li>
<li class="chapter" data-level="5" data-path="multiple-reg.html"><a href="multiple-reg.html"><i class="fa fa-check"></i><b>5</b> Multiple Regression</a></li>
<li class="chapter" data-level="6" data-path="categorical-vars.html"><a href="categorical-vars.html"><i class="fa fa-check"></i><b>6</b> Categorial Variables</a></li>
<li class="chapter" data-level="7" data-path="quantreg.html"><a href="quantreg.html"><i class="fa fa-check"></i><b>7</b> Quantile Regression</a></li>
<li class="chapter" data-level="8" data-path="panel-data.html"><a href="panel-data.html"><i class="fa fa-check"></i><b>8</b> Panel Data</a></li>
<li class="chapter" data-level="9" data-path="IV.html"><a href="IV.html"><i class="fa fa-check"></i><b>9</b> Instrumental Variables</a></li>
<li class="chapter" data-level="10" data-path="logit-probit.html"><a href="logit-probit.html"><i class="fa fa-check"></i><b>10</b> Logit and Probit</a></li>
<li class="chapter" data-level="11" data-path="pca.html"><a href="pca.html"><i class="fa fa-check"></i><b>11</b> Principal Component Analysis</a></li>
<li class="chapter" data-level="12" data-path="notes.html"><a href="notes.html"><i class="fa fa-check"></i><b>12</b> Notes</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Econometrics with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="categorical-vars" class="section level1">
<h1><span class="header-section-number">Chapter 6</span> Categorial Variables</h1>
<p>TODO: excluded category vs intercept?</p>
<p>Up until now, we have encountered only examples with <em>continuous</em> variables <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, that is, <span class="math inline">\(x,y \in \mathbb{R}\)</span>, so that a typical observation could have been <span class="math inline">\((y_i,x_i) = (1.5,5.62)\)</span>. There are many situations where it makes sense to think about the data in terms of <em>categories</em>, rather than continuous numbers. For example, whether an observation <span class="math inline">\(i\)</span> is <em>male</em> or <em>female</em>, whether a pixel on a screen is <em>black</em> or <em>white</em>, and whether a good was produced in <em>France</em>, <em>Germany</em>, <em>Italy</em>, <em>China</em> or <em>Spain</em> are all categorical classifications of data.</p>
<p>Probably the simplest type of categorical variable is the <em>binary</em>, <em>boolean</em>, or just <em>dummy</em> variable. As the name suggests, it can take on only two values, <code>0</code> and <code>1</code>, or <code>TRUE</code> and <code>FALSE</code>. Even though this is an extremely parsimonious way of encoding that, it is a very powerful tool that allows us to represent that a certain observation <span class="math inline">\(i\)</span> <strong>is a member</strong> of a certain category <span class="math inline">\(j\)</span>. For example, we could have a variable called <code>is.male</code> that is <code>TRUE</code> whenever <span class="math inline">\(i\)</span> is male, and <code>FALSE</code> otherwise. A common way to represent this is with the so-called <em>indicator function</em> <span class="math inline">\(\mathbf{1}[\text{condition}]\)</span>,</p>
<span class="math display">\[\begin{align*}
\text{is.male}_i &amp;= \mathbf{1}[\text{sex}_i==\text{male}], \\
\end{align*}\]</span>
<p>which would just mean</p>
<span class="math display">\[\begin{align*}
\mathbf{1}[\text{sex}_i==\text{male}] &amp;= \begin{cases}
                    1 &amp; \text{if }i\text{ is male} \\
                    0 &amp; \text{if }i\text{ is female}. \\
                 \end{cases}
\end{align*}\]</span>
<p>Notice the use of <code>x == y</code> to represent the relationship <em><code>x</code> is equal <code>y</code></em>, which is (very!) different from <code>x = y</code> meaning <em>assign <code>y</code> to <code>x</code></em>.</p>
<p>In terms of a regression formulation, this is our model when our regressor is binary:</p>
<p><span class="math display" id="eq:zero-one-reg">\[
y_i = \beta_0 + \beta_1 x_i + \varepsilon_i,x_i\in\{0,1\} \tag{6.1}
\]</span></p>
<p>Let’s run that regression here:</p>
<pre><code>## 
## Call:
## lm(formula = y ~ x, data = dta)
## 
## Coefficients:
## (Intercept)            x  
##       1.889        3.756</code></pre>
<p>We have seen in the <code>app</code> launched via</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">launchApp</span>(<span class="st">&quot;reg_dummy&quot;</span>)</code></pre></div>
<p>that this regression simplifies to the straight line connecting the mean, or the <em>expected value</em> of <span class="math inline">\(y\)</span> when <span class="math inline">\(x=0\)</span>, i.e. <span class="math inline">\(E[y|x=0]\)</span>, to the mean when <span class="math inline">\(x=1\)</span>, i.e. <span class="math inline">\(E[y|x=1]\)</span>. It is useful to remember that the <em>unconditional mean</em> of <span class="math inline">\(y\)</span>, i.e. <span class="math inline">\(E[y]\)</span>, is going to be the result of regressing <span class="math inline">\(y\)</span> only on an intercept, illustrated by the red line. The red line will always lie in between both conditional means. Let’s just refresh our memory by replicating the graph from the <code>app</code> here in figure <a href="categorical-vars.html#fig:x-zero-one">6.1</a>:</p>
<div class="figure" style="text-align: center"><span id="fig:x-zero-one"></span>
<img src="ScPoEconometrics_files/figure-html/x-zero-one-1.png" alt="regressing $y \in \mathbb{R}$ on $x \in \{0,1\}$. The red line is $E[y]$" width="672" />
<p class="caption">
Figure 6.1: regressing <span class="math inline">\(y \in \mathbb{R}\)</span> on <span class="math inline">\(x \in \{0,1\}\)</span>. The red line is <span class="math inline">\(E[y]\)</span>
</p>
</div>
<p>Now suppose for a moment that in fact</p>
<p><span class="math display">\[
x_i = \begin{cases}
          1 &amp; \text{if }i\text{ is male} \\
            0 &amp; \text{if }i\text{ is female}. \\
   \end{cases}
\]</span> and that <span class="math inline">\(y_i\)</span> is a measure of <span class="math inline">\(i\)</span>’s annual labor income. The dummy variable version of the above regression is just</p>
<span class="math display" id="eq:dummy-reg">\[
y_i = \beta_0 + \alpha \text{is.male}_i + \varepsilon_i \tag{6.2}
\]</span> where
<span class="math display">\[\begin{align*}
\text{is.male}_i &amp;= \mathbf{1}[x_i==1], \\
\end{align*}\]</span>
<p>and the resulting estimates of <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\alpha\)</span> are in fact the same. Here we see the estimates from <a href="categorical-vars.html#eq:dummy-reg">(6.2)</a>:</p>
<pre><code>## 
## Call:
## lm(formula = y ~ is.male, data = dta)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.40227 -0.50683 -0.09763  0.66287  1.53463 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   1.8888     0.2617   7.217 1.03e-06 ***
## is.male1      3.7558     0.3902   9.626 1.60e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.868 on 18 degrees of freedom
## Multiple R-squared:  0.8374, Adjusted R-squared:  0.8283 
## F-statistic: 92.67 on 1 and 18 DF,  p-value: 1.599e-08</code></pre>
<p>It is interesting to note that the estimate for <span class="math inline">\(\alpha = 3.7558\)</span> (and <span class="math inline">\(\beta_1 = 3.7558\)</span>!) is the same as the difference in conditional means:</p>
<p><span class="math display">\[E[y|x=1] - E[y|x=0]=3.7558.\]</span></p>
<div id="categorical-variables-in-r-factor" class="section level2">
<h2><span class="header-section-number">6.1</span> Categorical Variables in <code>R</code>: <code>factor</code></h2>
<p><code>R</code> has extensive support for categorical variables built-in. The relevant data type representing a categorical variable is called <code>factor</code>. We encountered them as basic data types in section <a href="R-intro.html#data-types">1.5</a> already, but it is worth repeating this here. We have seen that a factor <em>categorizes</em> a usually small number of numeric values by <em>labels</em>, as in this example which is similar to what I used to create regressor <code>is.male</code> for the above regression:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">is.male =<span class="st"> </span><span class="kw">factor</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="ot">FALSE</span>,<span class="ot">TRUE</span>))
is.male</code></pre></div>
<pre><code>## [1] FALSE TRUE  TRUE  FALSE
## Levels: FALSE TRUE</code></pre>
<p>You can see the result is a vector object of type <code>factor</code> with 4 entries, whereby <code>0</code> is represented as <code>FALSE</code> and <code>1</code> as <code>TRUE</code>. An other example could be if we wanted to record a variable <em>sex</em> instead, and we could do</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sex =<span class="st"> </span><span class="kw">factor</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;female&quot;</span>,<span class="st">&quot;male&quot;</span>))
sex</code></pre></div>
<pre><code>## [1] female male   male   female
## Levels: female male</code></pre>
<p>You can see that this is almost identical, just the <em>labels</em> are different.</p>
<div id="more-levels" class="section level3">
<h3><span class="header-section-number">6.1.1</span> More Levels</h3>
<p>We can go <em>binary</em> categorical variables such as <code>TRUE</code> vs <code>FALSE</code>. For example, suppose that <span class="math inline">\(x\)</span> measures educational attainment, i.e. it is now something like <span class="math inline">\(x_i \in \{\text{high school,some college,BA,MSc}\}\)</span>. In <code>R</code> parlance, <em>high school, some college, BA, MSc</em> are the <strong>levels of factor <span class="math inline">\(x\)</span></strong>. A straightforward extension of the above would dictate to create one dummy variable for each category (or level), like</p>
<span class="math display">\[\begin{align*}
\text{has.HS}_i &amp;= \mathbf{1}[x_i==\text{high school}] \\
\text{has.someCol}_i &amp;= \mathbf{1}[x_i==\text{some college}] \\
\text{has.BA}_i &amp;= \mathbf{1}[x_i==\text{BA}] \\
\text{has.MSc}_i &amp;= \mathbf{1}[x_i==\text{MSc}] 
\end{align*}\]</span>
<p>but you can see that this is cumbersome. There is a better solution for us available:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">factor</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">4</span>),<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;someCol&quot;</span>,<span class="st">&quot;BA&quot;</span>,<span class="st">&quot;MSc&quot;</span>))</code></pre></div>
<pre><code>## [1] HS      HS      someCol MSc     BA      MSc    
## Levels: HS someCol BA MSc</code></pre>
<p>Notice here that <code>R</code> will apply the labels in increasing order the way you supplied it (i.e. a numerical value <code>4</code> will correspond to “MSc”, no matter the ordering in <code>x</code>.)</p>
</div>
<div id="factor-and-lm" class="section level3">
<h3><span class="header-section-number">6.1.2</span> <code>factor</code> and <code>lm()</code></h3>
<p>The above developed <code>factor</code> terminology fits neatly into <code>R</code>’s linear model fitting framework. Let us illustrate the simplest use by way of example.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(Ecdat)  <span class="co"># need to load this library</span>
<span class="kw">data</span>(<span class="st">&quot;Wages&quot;</span>)   <span class="co"># from Ecdat</span>
<span class="kw">str</span>(Wages)   <span class="co"># let&#39;s examine this dataset!</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    4165 obs. of  12 variables:
##  $ exp    : int  3 4 5 6 7 8 9 30 31 32 ...
##  $ wks    : int  32 43 40 39 42 35 32 34 27 33 ...
##  $ bluecol: Factor w/ 2 levels &quot;no&quot;,&quot;yes&quot;: 1 1 1 1 1 1 1 2 2 2 ...
##  $ ind    : int  0 0 0 0 1 1 1 0 0 1 ...
##  $ south  : Factor w/ 2 levels &quot;no&quot;,&quot;yes&quot;: 2 2 2 2 2 2 2 1 1 1 ...
##  $ smsa   : Factor w/ 2 levels &quot;no&quot;,&quot;yes&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ married: Factor w/ 2 levels &quot;no&quot;,&quot;yes&quot;: 2 2 2 2 2 2 2 2 2 2 ...
##  $ sex    : Factor w/ 2 levels &quot;female&quot;,&quot;male&quot;: 2 2 2 2 2 2 2 2 2 2 ...
##  $ union  : Factor w/ 2 levels &quot;no&quot;,&quot;yes&quot;: 1 1 1 1 1 1 1 1 1 2 ...
##  $ ed     : int  9 9 9 9 9 9 9 11 11 11 ...
##  $ black  : Factor w/ 2 levels &quot;no&quot;,&quot;yes&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ lwage  : num  5.56 5.72 6 6 6.06 ...</code></pre>
<p>Assume that this is a single cross section for wages of US workers. The main outcome variable is <code>lwage</code> which stands for <em>logarithm of wage</em>. Let’s initially say that a workers wage depends only on his <em>experience</em>, measured in the number of years he/she worked full-time:</p>
<p><span class="math display" id="eq:wage-exp">\[
\ln w_i = \beta_0 + \beta_1 exp_i + \varepsilon_i \tag{6.3}
\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lm_w =<span class="st"> </span><span class="kw">lm</span>(lwage <span class="op">~</span><span class="st"> </span>exp, <span class="dt">data =</span> Wages)
<span class="kw">summary</span>(lm_w)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = lwage ~ exp, data = Wages)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.30153 -0.29144  0.02307  0.27927  1.97171 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 6.5014318  0.0144657  449.44   &lt;2e-16 ***
## exp         0.0088101  0.0006378   13.81   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.4513 on 4163 degrees of freedom
## Multiple R-squared:  0.04383,    Adjusted R-squared:  0.0436 
## F-statistic: 190.8 on 1 and 4163 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>We see from this that an additional year of full-time work experience will increase the mean of <span class="math inline">\(\ln w\)</span> by 0.0088. Given the log transformation on wages, we can just exponentiate that to get an estimated effect on the (geometric!) mean of wages as <span class="math inline">\(\exp(\hat{\beta}_1) = 1.0088491\)</span>. This means that hourly wages increase by roughly <span class="math inline">\(100 * (\exp(\hat{\beta}_1)-1) = 0.88\)</span> percent with an additional year of experience. We can verify the positive relationship in figure <a href="categorical-vars.html#fig:wage-plot">6.2</a>.</p>
<div class="figure" style="text-align: center"><span id="fig:wage-plot"></span>
<img src="ScPoEconometrics_files/figure-html/wage-plot-1.png" alt="log wage vs experience. Red line shows the regression." width="672" />
<p class="caption">
Figure 6.2: log wage vs experience. Red line shows the regression.
</p>
</div>
<p>Now let’s investigate whether this relationship different for men and women.</p>
<p><span class="math display" id="eq:wage-sex">\[
\ln w_i = \beta_0 + \beta_1 exp_i + \beta_2 sex_i + \varepsilon_i \tag{6.4}
\]</span></p>
<p>We can do this easily by using the <code>update</code> function as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lm_sex =<span class="st"> </span><span class="kw">update</span>(lm_w, . <span class="op">~</span><span class="st"> </span>. <span class="op">+</span><span class="st"> </span>sex)  <span class="co"># update lm_w with same LHS, same RHS, but add sex to it</span>
<span class="kw">summary</span>(lm_sex)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = lwage ~ exp + sex, data = Wages)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.87081 -0.26688  0.01733  0.26336  1.90325 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 6.1257661  0.0223319  274.31   &lt;2e-16 ***
## exp         0.0076134  0.0006082   12.52   &lt;2e-16 ***
## sexmale     0.4501101  0.0210974   21.34   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.4286 on 4162 degrees of freedom
## Multiple R-squared:  0.1381, Adjusted R-squared:  0.1377 
## F-statistic: 333.4 on 2 and 4162 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>What’s going on here? Remember from above that <code>sex</code> is a <code>factor</code> with 2 levels <em>female</em> and <em>male</em>. We see in the above output that <code>R</code> included a regressor called <code>sexmale</code> <span class="math inline">\(=\mathbf{1}[sex_i==&quot;male&quot;]\)</span>. This is a combination of the variable name <code>sex</code> and the level which was included in the regression. In other words, <code>R</code> chooses a <em>reference category</em> (by default the first of all levels by order of appearance), which is excluded - here this is <code>sex==&quot;female&quot;</code>. The interpretation is that <span class="math inline">\(\beta_2\)</span> measures the effect of being male <em>relative</em> to being female. <code>R</code> automatically creates a dummy variable for each potential level, excluding the first category. In particular, if <code>sex</code> had a third category <code>dont want to say</code>, there would be an additional regressor called <code>sexdontwanttosay</code>.</p>
<div class="figure" style="text-align: center"><span id="fig:wage-plot2"></span>
<img src="ScPoEconometrics_files/figure-html/wage-plot2-1.png" alt="log wage vs experience with different intercepts by sex" width="672" />
<p class="caption">
Figure 6.3: log wage vs experience with different intercepts by sex
</p>
</div>
<p>Figure <a href="categorical-vars.html#fig:wage-plot2">6.3</a> illustrates this. You can see that both male and female have the same upward sloping regression line. But you can also see that there is a parallel downward shift from male to female line. The estimate of <span class="math inline">\(\beta_2 = 0.45\)</span> is the size of the downward shift.</p>
</div>
</div>
<div id="saturated-models-main-effects-and-interactions" class="section level2">
<h2><span class="header-section-number">6.2</span> Saturated Models: Main Effects and Interactions</h2>
<p>You can see above that we <em>restricted</em> male and female to have the same slope with repect to years of experience. This may or may not be a good assumption. Thankfully, the dummy variable regression machinery allows for a quick solution to this - so-called <em>interaction</em> effects. As already introduced in chapter <a href="multiple-reg.html#mreg-interactions">5.2</a>, interactions allow that the <em>ceteris paribus</em> effect of a certain regressor, <code>exp</code> say, depends also on the value of yet another regressor, <code>sex</code> for example. Suppose then we would like to see whether male and female not only have different intercepts, but also different slopes with respect to <code>exp</code> in figure <a href="categorical-vars.html#fig:wage-plot2">6.3</a>. Therefore we formulate this version of our model:</p>
<p><span class="math display" id="eq:wage-sex-inter">\[
\ln w_i = \beta_0 + \beta_1 exp_i + \beta_2 sex_i + \beta_3 (sex_i \times exp_i) + \varepsilon_i \tag{6.5}
\]</span></p>
<p>The inclusion of the <em>product</em> of <code>exp</code> and <code>sex</code> amounts to having different slopes for different categories in <code>sex</code>. This is easy to see if we take the partial derivative of <a href="categorical-vars.html#eq:wage-sex-inter">(6.5)</a> with respect to <code>sex</code>:</p>
<p><span class="math display" id="eq:wage-sex-inter-deriv">\[
\frac{\partial \ln w_i}{\partial sex_i} = \beta_2 + \beta_3 exp_i \tag{6.6}
\]</span></p>
<div class="tip">
<p>
You should go back to chapter <span class="citation">(<span class="citeproc-not-found" data-reference-id="ref"><strong>???</strong></span>)</span>(multiple-reg) and in particular equation <span class="citation">(<span class="citeproc-not-found" data-reference-id="ref"><strong>???</strong></span>)</span>(eq:abline2d-deriv) to remind yourself of what a <em>partial effect</em> was, and how exactly the present <span class="citation">(<span class="citeproc-not-found" data-reference-id="ref"><strong>???</strong></span>)</span>(eq:wage-sex-inter-deriv) differs from what we saw there.
</p>
</div>
<p><br> Back in our <code>R</code> session, we can run the full interactions model like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lm_inter =<span class="st"> </span><span class="kw">lm</span>(lwage <span class="op">~</span><span class="st"> </span>exp<span class="op">*</span>sex, <span class="dt">data =</span> Wages)
<span class="kw">summary</span>(lm_inter)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = lwage ~ exp * sex, data = Wages)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.82137 -0.26797  0.01781  0.26231  1.90757 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 6.169017   0.038165 161.643  &lt; 2e-16 ***
## exp         0.005071   0.001918   2.644  0.00822 ** 
## sexmale     0.401116   0.040917   9.803  &lt; 2e-16 ***
## exp:sexmale 0.002826   0.002022   1.397  0.16236    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.4285 on 4161 degrees of freedom
## Multiple R-squared:  0.1385, Adjusted R-squared:  0.1379 
## F-statistic:   223 on 3 and 4161 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>You can see here that <code>R</code> automatically expands <code>exp*sex</code> to include both <em>main effects</em>, i.e. <code>exp</code> and <code>sex</code> as single regressors as before, and their interaction, denoted by <code>exp:sexmale</code>. It turns out that in this example, the estimate for the interaction is not statistically significant, i.e. we cannot reject the null hypothesis that <span class="math inline">\(\beta_3 = 0\)</span>. (If, for some reason, you wanted to include only the interaction, you could supply directly <code>formula = lwage ~ exp:sex</code> to <code>lm</code>, although this would be a rather difficult to interpret model.)</p>
<p>We call a model like <a href="categorical-vars.html#eq:wage-sex-inter">(6.5)</a> a <em>saturated model</em>, because it includes all main effects and possible interactions. What our little exercise showed us was that with the sample of data at hand, we cannot actually claim that there exists a differential slope for male and female, so the model with main effects only may be more appropriate here.</p>
<p>To finally illustrate the limits of interpretability when including interactions, suppose we run the fully saturated model for <code>sex</code>, <code>smsa</code>, <code>union</code> and <code>bluecol</code>, including all main and all interaction effects:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lm_full =<span class="st"> </span><span class="kw">lm</span>(lwage <span class="op">~</span><span class="st"> </span>sex<span class="op">*</span>smsa<span class="op">*</span>union<span class="op">*</span>bluecol,<span class="dt">data=</span>Wages)
<span class="kw">summary</span>(lm_full)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = lwage ~ sex * smsa * union * bluecol, data = Wages)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.95214 -0.23409 -0.01681  0.25317  1.90450 
## 
## Coefficients:
##                                     Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)                          6.12378    0.06300  97.198  &lt; 2e-16
## sexmale                              0.67057    0.06577  10.195  &lt; 2e-16
## smsayes                              0.33424    0.06872   4.864 1.19e-06
## unionyes                             0.84284    0.16866   4.997 6.06e-07
## bluecolyes                          -0.34016    0.08423  -4.039 5.47e-05
## sexmale:smsayes                     -0.15917    0.07226  -2.203 0.027670
## sexmale:unionyes                    -0.92893    0.17816  -5.214 1.94e-07
## smsayes:unionyes                    -0.83927    0.17979  -4.668 3.14e-06
## sexmale:bluecolyes                  -0.15046    0.08820  -1.706 0.088100
## smsayes:bluecolyes                  -0.12471    0.09727  -1.282 0.199882
## unionyes:bluecolyes                 -0.31819    0.22924  -1.388 0.165208
## sexmale:smsayes:unionyes             0.72672    0.19060   3.813 0.000139
## sexmale:smsayes:bluecolyes           0.25860    0.10327   2.504 0.012318
## sexmale:unionyes:bluecolyes          0.71906    0.23772   3.025 0.002503
## smsayes:unionyes:bluecolyes          0.50057    0.24862   2.013 0.044137
## sexmale:smsayes:unionyes:bluecolyes -0.58330    0.25899  -2.252 0.024361
##                                        
## (Intercept)                         ***
## sexmale                             ***
## smsayes                             ***
## unionyes                            ***
## bluecolyes                          ***
## sexmale:smsayes                     *  
## sexmale:unionyes                    ***
## smsayes:unionyes                    ***
## sexmale:bluecolyes                  .  
## smsayes:bluecolyes                     
## unionyes:bluecolyes                    
## sexmale:smsayes:unionyes            ***
## sexmale:smsayes:bluecolyes          *  
## sexmale:unionyes:bluecolyes         ** 
## smsayes:unionyes:bluecolyes         *  
## sexmale:smsayes:unionyes:bluecolyes *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3832 on 4149 degrees of freedom
## Multiple R-squared:  0.3129, Adjusted R-squared:  0.3105 
## F-statistic:   126 on 15 and 4149 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>The main effects remain clear to interpret: being a blue collar worker, for example, reduces average wages by 34% relative to white collar workers. One-way interactions are still ok to interpret as well: <code>sexmale:bluecolyes</code> indicates in addition to a wage premium over females of 0.67, and a penalty of being blue collar of -0.34, <strong>male</strong> blue collar workers suffer an additional wage loss of -0.15. All of this is relative to the base category, which are female white collar workers who don’t live in an smsa and are not union members. If we now add a third or even a fourth interaction, this becomes much harder to interpret, and in fact we rarely see such interactions in applied work.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="multiple-reg.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="quantreg.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ScPoEcon/ScPoEconometrics/edit/master/07-Categorial-Vars.Rmd",
"text": "Edit"
},
"download": ["ScPoEconometrics.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
